var eventSynthesizerFunction;
function getEventSynthesizier() {
    if (eventSynthesizerFunction)
        return eventSynthesizerFunction;
    var currentMouseTarget;
    var fireMouseLeaveEvents = function (target, relatedTarget, uievent) {
        if (!target)
            return;
        var eventInit = {
            view: uievent.view,
            clientX: uievent.clientX,
            clientY: uievent.clientY,
            screenX: uievent.screenX,
            screenY: uievent.screenY,
            relatedTarget: relatedTarget
        };
        // fire mouseout
        eventInit.bubbles = true;
        target.dispatchEvent(new MouseEvent('mouseout', eventInit));
        // fire mouseleave events
        eventInit.bubbles = false;
        var el = target;
        do {
            el.dispatchEvent(new MouseEvent('mouseleave', eventInit));
            el = el['parentElement'];
        } while (el);
    };
    var fireMouseEnterEvents = function (target, relatedTarget, uievent) {
        var eventInit = {
            view: uievent.view,
            clientX: uievent.clientX,
            clientY: uievent.clientY,
            screenX: uievent.screenX,
            screenY: uievent.screenY,
            relatedTarget: relatedTarget
        };
        // fire mouseover
        eventInit.bubbles = true;
        target.dispatchEvent(new MouseEvent('mouseover', eventInit));
        // fire mouseenter events
        eventInit.bubbles = false;
        var el = target;
        do {
            el.dispatchEvent(new MouseEvent('mouseenter', eventInit));
            el = el['parentElement'];
        } while (el);
    };
    var firePointerEnterEvents = function (target, relatedTarget, uievent) {
        var bubbles = uievent.bubbles;
        // fire pointerover event
        uievent.bubbles = true;
        target.dispatchEvent(new PointerEvent('pointerover', uievent));
        // fire pointerenter events
        uievent.bubbles = false;
        var el = target;
        do {
            el.dispatchEvent(new PointerEvent('pointerenter', uievent));
            el = el['parentElement'];
        } while (el);
        uievent.bubbles = bubbles;
    };
    var firePointerLeaveEvents = function (target, relatedTarget, uievent) {
        if (!target)
            return;
        // fire pointerover event
        uievent.bubbles = true;
        target.dispatchEvent(new PointerEvent('pointerout', uievent));
        // fire pointerenter events
        uievent.bubbles = false;
        var el = target;
        do {
            el.dispatchEvent(new PointerEvent('pointerleave', uievent));
            el = el['parentElement'];
        } while (el);
    };
    var deserializeTouches = function (touches, target, uievent) {
        touches.forEach(function (t, i) {
            if (document.createTouch) {
                touches[i] = document.createTouch(uievent.view, target, t.identifier, t.clientX, t.clientY, t.screenX, t.screenY);
            }
            else if (typeof Touch !== undefined) {
                t.target = target;
                touches[i] = new Touch(t);
            }
        });
        return touches;
    };
    var touchTargets = {};
    var touchStartTimes = {};
    var pointerTargets = {};
    var capturedPointerTargets = {};
    document.documentElement.addEventListener('gotpointercapture', function (e) {
        capturedPointerTargets[e.pointerId] = e.target;
    });
    document.documentElement.addEventListener('lostpointercapture', function (e) {
        delete capturedPointerTargets[e.pointerId];
    });
    Element.prototype.setPointerCapture = function (id) { capturedPointerTargets[id] = this; };
    Element.prototype.releasePointerCapture = function (id) { capturedPointerTargets[id] = null; };
    return eventSynthesizerFunction = function (uievent) {
        uievent.view = window;
        var target;
        switch (uievent.type) {
            case 'wheel':
                target = document.elementFromPoint(uievent.clientX, uievent.clientY) || window;
                target.dispatchEvent(new WheelEvent(uievent.type, uievent));
                break;
            case 'mouseleave':
                target = document.elementFromPoint(uievent.clientX, uievent.clientY) || window;
                fireMouseLeaveEvents(currentMouseTarget, undefined, uievent);
                currentMouseTarget = undefined;
                break;
            case 'mouseenter':
                target = document.elementFromPoint(uievent.clientX, uievent.clientY) || window;
                fireMouseEnterEvents(target, undefined, uievent);
                currentMouseTarget = target;
                break;
            case 'mousemove':
                target = document.elementFromPoint(uievent.clientX, uievent.clientY) || window;
                if (target !== currentMouseTarget) {
                    fireMouseLeaveEvents(currentMouseTarget, target, uievent);
                    fireMouseEnterEvents(target, currentMouseTarget, uievent);
                    currentMouseTarget = target;
                }
                target.dispatchEvent(new MouseEvent(uievent.type, uievent));
                break;
            case 'touchstart':
                var primaryTouch = uievent.changedTouches[0];
                target = document.elementFromPoint(primaryTouch.clientX, primaryTouch.clientY) || window;
                for (var _i = 0, _a = uievent.changedTouches; _i < _a.length; _i++) {
                    var t = _a[_i];
                    touchTargets[t.identifier] = target;
                    touchStartTimes[t.identifier] = performance.now();
                }
            case 'touchmove':
            case 'touchend':
            case 'touchcancel':
                target = touchTargets[uievent.changedTouches[0].identifier];
                var evt = document.createEvent('TouchEvent');
                var touches = deserializeTouches(uievent.touches, target, uievent);
                var targetTouches = deserializeTouches(uievent.targetTouches, target, uievent);
                var changedTouches = deserializeTouches(uievent.changedTouches, target, uievent);
                if (document.createTouchList) {
                    touches = document.createTouchList.apply(document, touches);
                    targetTouches = document.createTouchList.apply(document, targetTouches);
                    changedTouches = document.createTouchList.apply(document, changedTouches);
                }
                // Safari, Firefox: must use initTouchEvent.
                if (typeof evt['initTouchEvent'] === "function") {
                    evt['initTouchEvent'](uievent.type, uievent.bubbles, uievent.cancelable, uievent.view, uievent.detail, uievent.screenX, uievent.screenY, uievent.clientX, uievent.clientY, uievent.ctrlKey, uievent.altKey, uievent.shiftKey, uievent.metaKey, touches, targetTouches, changedTouches, 1.0, 0.0);
                }
                else if ('TouchEvent' in window && TouchEvent.length > 0) {
                    // Chrome: must use TouchEvent constructor.
                    evt = new TouchEvent(uievent.type, {
                        cancelable: uievent.cancelable,
                        bubbles: uievent.bubbles,
                        touches: touches,
                        targetTouches: targetTouches,
                        changedTouches: changedTouches
                    });
                }
                else {
                    evt.initUIEvent(uievent.type, uievent.bubbles, uievent.cancelable, uievent.view, uievent.detail);
                    evt.touches = touches;
                    evt.targetTouches = targetTouches;
                    evt.changedTouches = changedTouches;
                }
                if (uievent.type === 'touchend' || uievent.type == 'touchcancel') {
                    target.dispatchEvent(evt);
                    var primaryTouch_1 = changedTouches[0];
                    uievent.clientX = primaryTouch_1.clientX;
                    uievent.clientY = primaryTouch_1.clientY;
                    uievent.screenX = primaryTouch_1.screenX;
                    uievent.screenY = primaryTouch_1.screenY;
                    uievent.button = 0;
                    uievent.detail = 1;
                    if (uievent.type === 'touchend') {
                        if (performance.now() - touchStartTimes[primaryTouch_1.identifier] < 300 && !evt.defaultPrevented) {
                            target.dispatchEvent(new MouseEvent('mousedown', uievent));
                            target.dispatchEvent(new MouseEvent('mouseup', uievent));
                            target.dispatchEvent(new MouseEvent('click', uievent));
                        }
                    }
                    else {
                        target.dispatchEvent(new MouseEvent('mouseout', uievent));
                    }
                    for (var _b = 0, _c = uievent.changedTouches; _b < _c.length; _b++) {
                        var t = _c[_b];
                        delete touchTargets[t.identifier];
                        delete touchStartTimes[t.identifier];
                    }
                }
                else {
                    target.dispatchEvent(evt);
                }
                break;
            case 'pointerenter':
            case 'pointerleave':
            case 'pointermove':
            case 'pointercancel':
            case 'pointerdown':
            case 'pointerup':
                var previousTarget = pointerTargets[uievent.pointerId];
                var capturedTarget = target = capturedPointerTargets[uievent.pointerId];
                var isLeaving = uievent.type === 'pointerleave' || uievent.type === 'pointercancel';
                var pointerEvent = new PointerEvent(uievent.type, uievent);
                if (capturedTarget) {
                    capturedTarget.dispatchEvent(pointerEvent);
                }
                else {
                    target = document.elementFromPoint(uievent.clientX, uievent.clientY) || window;
                    if (target !== previousTarget) {
                        firePointerLeaveEvents(previousTarget, target, uievent);
                        if (!isLeaving)
                            firePointerEnterEvents(target, previousTarget, uievent);
                    }
                    target.dispatchEvent(pointerEvent);
                }
                if (isLeaving) {
                    delete pointerTargets[uievent.pointerId];
                }
                else {
                    pointerTargets[uievent.pointerId] = target;
                }
                break;
            default:
                target = document.elementFromPoint(uievent.clientX, uievent.clientY) || window;
                target.dispatchEvent(new MouseEvent(uievent.type, uievent));
        }
    };
}
export default (typeof document !== 'undefined' && document.createElement) ?
    getEventSynthesizier : function () { return undefined; };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWktZXZlbnQtc3ludGhlc2l6ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1aS1ldmVudC1zeW50aGVzaXplci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxJQUFJLHdCQUFnRCxDQUFDO0FBRXJEO0lBQ0ksRUFBRSxDQUFDLENBQUMsd0JBQXdCLENBQUM7UUFBQyxNQUFNLENBQUMsd0JBQXdCLENBQUM7SUFFOUQsSUFBSSxrQkFBMkMsQ0FBQztJQUVoRCxJQUFNLG9CQUFvQixHQUFHLFVBQUMsTUFBK0IsRUFBRSxhQUFzQyxFQUFFLE9BQWtCO1FBQ3JILEVBQUUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1lBQUMsTUFBTSxDQUFDO1FBQ3BCLElBQU0sU0FBUyxHQUFrQjtZQUM3QixJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUk7WUFDbEIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxPQUFPO1lBQ3hCLE9BQU8sRUFBRSxPQUFPLENBQUMsT0FBTztZQUN4QixPQUFPLEVBQUUsT0FBTyxDQUFDLE9BQU87WUFDeEIsT0FBTyxFQUFFLE9BQU8sQ0FBQyxPQUFPO1lBQ3hCLGFBQWEsRUFBRSxhQUFhO1NBQy9CLENBQUM7UUFDRixnQkFBZ0I7UUFDaEIsU0FBUyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDekIsTUFBTSxDQUFDLGFBQWEsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxVQUFVLEVBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUMzRCx5QkFBeUI7UUFDekIsU0FBUyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7UUFDMUIsSUFBSSxFQUFFLEdBQUcsTUFBTSxDQUFDO1FBQ2hCLEdBQUcsQ0FBQztZQUNBLEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxVQUFVLENBQUMsWUFBWSxFQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDekQsRUFBRSxHQUFHLEVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUM3QixDQUFDLFFBQVEsRUFBRSxFQUFD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QUFjLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDO3dCQUN4RCxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQzs0QkFBQyxzQkFBc0IsQ0FBQyxNQUFNLEVBQUUsY0FBYyxFQUFFLE9BQU8sQ0FBQyxDQUFDO29CQUM1RSxDQUFDO29CQUNELE1BQU0sQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLENBQUM7Z0JBQ3ZDLENBQUM7Z0JBRUQsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztvQkFDWixPQUFPLGNBQWMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBQzdDLENBQUM7Z0JBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ0osY0FBYyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsR0FBRyxNQUFNLENBQUM7Z0JBQy9DLENBQUM7Z0JBRUQsS0FBSyxDQUFDO1lBQ1Y7Z0JBQ0ksTUFBTSxHQUFHLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxNQUFNLENBQUM7Z0JBQy9FLE1BQU0sQ0FBQyxhQUFhLENBQUMsSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ3BFLENBQUM7SUFDTCxDQUFDLENBQUM7QUFDTixDQUFDO0FBRUQsZUFBZSxDQUFDLE9BQU8sUUFBUSxLQUFLLFdBQVcsSUFBSSxRQUFRLENBQUMsYUFBYSxDQUFDO0lBQ3RFLG9CQUFvQixHQUFHLGNBQU0sTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxubGV0IGV2ZW50U3ludGhlc2l6ZXJGdW5jdGlvbjoodWlldmVudDpVSUV2ZW50KT0+dm9pZDtcblxuZnVuY3Rpb24gZ2V0RXZlbnRTeW50aGVzaXppZXIoKSB7XG4gICAgaWYgKGV2ZW50U3ludGhlc2l6ZXJGdW5jdGlvbikgcmV0dXJuIGV2ZW50U3ludGhlc2l6ZXJGdW5jdGlvbjtcbiAgICBcbiAgICBsZXQgY3VycmVudE1vdXNlVGFyZ2V0OkVsZW1lbnR8V2luZG93fHVuZGVmaW5lZDtcblxuICAgIGNvbnN0IGZpcmVNb3VzZUxlYXZlRXZlbnRzID0gKHRhcmdldDpFbGVtZW50fFdpbmRvd3x1bmRlZmluZWQsIHJlbGF0ZWRUYXJnZXQ6RWxlbWVudHxXaW5kb3d8dW5kZWZpbmVkLCB1aWV2ZW50Ok1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjtcbiAgICAgICAgY29uc3QgZXZlbnRJbml0Ok1vdXNlRXZlbnRJbml0ID0ge1xuICAgICAgICAgICAgdmlldzogdWlldmVudC52aWV3LFxuICAgICAgICAgICAgY2xpZW50WDogdWlldmVudC5jbGllbnRYLFxuICAgICAgICAgICAgY2xpZW50WTogdWlldmVudC5jbGllbnRZLFxuICAgICAgICAgICAgc2NyZWVuWDogdWlldmVudC5zY3JlZW5YLFxuICAgICAgICAgICAgc2NyZWVuWTogdWlldmVudC5zY3JlZW5ZLFxuICAgICAgICAgICAgcmVsYXRlZFRhcmdldDogcmVsYXRlZFRhcmdldFxuICAgICAgICB9O1xuICAgICAgICAvLyBmaXJlIG1vdXNlb3V0XG4gICAgICAgIGV2ZW50SW5pdC5idWJibGVzID0gdHJ1ZTtcbiAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IE1vdXNlRXZlbnQoJ21vdXNlb3V0JyxldmVudEluaXQpKTtcbiAgICAgICAgLy8gZmlyZSBtb3VzZWxlYXZlIGV2ZW50c1xuICAgICAgICBldmVudEluaXQuYnViYmxlcyA9IGZhbHNlO1xuICAgICAgICBsZXQgZWwgPSB0YXJnZXQ7XG4gICAgICAgIGRvIHsgXG4gICAgICAgICAgICBlbC5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KCdtb3VzZWxlYXZlJyxldmVudEluaXQpKTtcbiAgICAgICAgICAgIGVsID0gZWxbJ3BhcmVudEVsZW1lbnQnXTtcbiAgICAgICAgfSB3aGlsZSAoZWwpXG4gICAgfVxuXG4gICAgY29uc3QgZmlyZU1vdXNlRW50ZXJFdmVudHMgPSAodGFyZ2V0OkVsZW1lbnR8V2luZG93LCByZWxhdGVkVGFyZ2V0OkVsZW1lbnR8V2luZG93fHVuZGVmaW5lZCwgdWlldmVudDpNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50SW5pdDpNb3VzZUV2ZW50SW5pdCA9IHtcbiAgICAgICAgICAgIHZpZXc6IHVpZXZlbnQudmlldyxcbiAgICAgICAgICAgIGNsaWVudFg6IHVpZXZlbnQuY2xpZW50WCxcbiAgICAgICAgICAgIGNsaWVudFk6IHVpZXZlbnQuY2xpZW50WSxcbiAgICAgICAgICAgIHNjcmVlblg6IHVpZXZlbnQuc2NyZWVuWCxcbiAgICAgICAgICAgIHNjcmVlblk6IHVpZXZlbnQuc2NyZWVuWSxcbiAgICAgICAgICAgIHJlbGF0ZWRUYXJnZXQ6IHJlbGF0ZWRUYXJnZXRcbiAgICAgICAgfTtcbiAgICAgICAgLy8gZmlyZSBtb3VzZW92ZXJcbiAgICAgICAgZXZlbnRJbml0LmJ1YmJsZXMgPSB0cnVlO1xuICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudCgnbW91c2VvdmVyJyxldmVudEluaXQpKTtcbiAgICAgICAgLy8gZmlyZSBtb3VzZWVudGVyIGV2ZW50c1xuICAgICAgICBldmVudEluaXQuYnViYmxlcyA9IGZhbHNlO1xuICAgICAgICBsZXQgZWwgPSB0YXJnZXQ7XG4gICAgICAgIGRvIHsgXG4gICAgICAgICAgICBlbC5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KCdtb3VzZWVudGVyJyxldmVudEluaXQpKTtcbiAgICAgICAgICAgIGVsID0gZWxbJ3BhcmVudEVsZW1lbnQnXTtcbiAgICAgICAgfSB3aGlsZSAoZWwpXG4gICAgfVxuXG4gICAgY29uc3QgZmlyZVBvaW50ZXJFbnRlckV2ZW50cyA9ICh0YXJnZXQ6RWxlbWVudHxXaW5kb3csIHJlbGF0ZWRUYXJnZXQ6YW55LCB1aWV2ZW50OlBvaW50ZXJFdmVudCkgPT4ge1xuICAgICAgICBjb25zdCBidWJibGVzID0gdWlldmVudC5idWJibGVzO1xuICAgICAgICAvLyBmaXJlIHBvaW50ZXJvdmVyIGV2ZW50XG4gICAgICAgICg8YW55PnVpZXZlbnQpLmJ1YmJsZXMgPSB0cnVlO1xuICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgUG9pbnRlckV2ZW50KCdwb2ludGVyb3ZlcicsdWlldmVudCkpO1xuICAgICAgICAvLyBmaXJlIHBvaW50ZXJlbnRlciBldmVudHNcbiAgICAgICAgKDxhbnk+dWlldmVudCkuYnViYmxlcyA9IGZhbHNlO1xuICAgICAgICBsZXQgZWwgPSB0YXJnZXQ7XG4gICAgICAgIGRvIHsgXG4gICAgICAgICAgICBlbC5kaXNwYXRjaEV2ZW50KG5ldyBQb2ludGVyRXZlbnQoJ3BvaW50ZXJlbnRlcicsdWlldmVudCkpO1xuICAgICAgICAgICAgZWwgPSBlbFsncGFyZW50RWxlbWVudCddO1xuICAgICAgICB9IHdoaWxlIChlbClcbiAgICAgICAgKDxhbnk+dWlldmVudCkuYnViYmxlcyA9IGJ1YmJsZXM7XG4gICAgfVxuXG4gICAgY29uc3QgZmlyZVBvaW50ZXJMZWF2ZUV2ZW50cyA9ICh0YXJnZXQ6RWxlbWVudHxXaW5kb3d8dW5kZWZpbmVkLCByZWxhdGVkVGFyZ2V0OmFueSwgdWlldmVudDpQb2ludGVyRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjtcbiAgICAgICAgLy8gZmlyZSBwb2ludGVyb3ZlciBldmVudFxuICAgICAgICAoPGFueT51aWV2ZW50KS5idWJibGVzID0gdHJ1ZTtcbiAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IFBvaW50ZXJFdmVudCgncG9pbnRlcm91dCcsdWlldmVudCkpO1xuICAgICAgICAvLyBmaXJlIHBvaW50ZXJlbnRlciBldmVudHNcbiAgICAgICAgKDxhbnk+dWlldmVudCkuYnViYmxlcyA9IGZhbHNlO1xuICAgICAgICBsZXQgZWwgPSB0YXJnZXQ7XG4gICAgICAgIGRvIHsgXG4gICAgICAgICAgICBlbC5kaXNwYXRjaEV2ZW50KG5ldyBQb2ludGVyRXZlbnQoJ3BvaW50ZXJsZWF2ZScsdWlldmVudCkpO1xuICAgICAgICAgICAgZWwgPSBlbFsncGFyZW50RWxlbWVudCddO1xuICAgICAgICB9IHdoaWxlIChlbClcbiAgICB9XG5cbiAgICBjb25zdCBkZXNlcmlhbGl6ZVRvdWNoZXMgPSAodG91Y2hlczpUb3VjaFtdLCB0YXJnZXQ6RWxlbWVudHxXaW5kb3csIHVpZXZlbnQ6VG91Y2hFdmVudCkgPT4ge1xuICAgICAgICB0b3VjaGVzLmZvckVhY2goKHQsIGkpPT57XG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuY3JlYXRlVG91Y2gpIHtcbiAgICAgICAgICAgICAgICB0b3VjaGVzW2ldID0gZG9jdW1lbnQuY3JlYXRlVG91Y2goXG4gICAgICAgICAgICAgICAgICAgIHVpZXZlbnQudmlldywgdGFyZ2V0LCB0LmlkZW50aWZpZXIsIFxuICAgICAgICAgICAgICAgICAgICB0LmNsaWVudFgsIHQuY2xpZW50WSwgdC5zY3JlZW5YLCB0LnNjcmVlbllcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgVG91Y2ggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICg8YW55PnQpLnRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICB0b3VjaGVzW2ldID0gbmV3ICg8YW55PlRvdWNoKSh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIHRvdWNoZXM7XG4gICAgfVxuICAgIFxuXG4gICAgY29uc3QgdG91Y2hUYXJnZXRzID0ge307XG4gICAgY29uc3QgdG91Y2hTdGFydFRpbWVzID0ge307XG5cbiAgICBjb25zdCBwb2ludGVyVGFyZ2V0cyA9IHt9O1xuICAgIGNvbnN0IGNhcHR1cmVkUG9pbnRlclRhcmdldHMgPSB7fTtcblxuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdnb3Rwb2ludGVyY2FwdHVyZScsIChlKT0+e1xuICAgICAgICBjYXB0dXJlZFBvaW50ZXJUYXJnZXRzW2UucG9pbnRlcklkXSA9IGUudGFyZ2V0O1xuICAgIH0pXG5cbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9zdHBvaW50ZXJjYXB0dXJlJywgKGUpPT57XG4gICAgICAgIGRlbGV0ZSBjYXB0dXJlZFBvaW50ZXJUYXJnZXRzW2UucG9pbnRlcklkXTtcbiAgICB9KVxuXG4gICAgRWxlbWVudC5wcm90b3R5cGUuc2V0UG9pbnRlckNhcHR1cmUgPSBmdW5jdGlvbiAoaWQpIHsgY2FwdHVyZWRQb2ludGVyVGFyZ2V0c1tpZF0gPSB0aGlzOyB9O1xuICAgIEVsZW1lbnQucHJvdG90eXBlLnJlbGVhc2VQb2ludGVyQ2FwdHVyZSA9IGZ1bmN0aW9uIChpZCkgeyBjYXB0dXJlZFBvaW50ZXJUYXJnZXRzW2lkXSA9IG51bGw7IH07XG5cbiAgICByZXR1cm4gZXZlbnRTeW50aGVzaXplckZ1bmN0aW9uID0gKHVpZXZlbnQ6TW91c2VFdmVudCZXaGVlbEV2ZW50JlRvdWNoRXZlbnQmUG9pbnRlckV2ZW50KT0+e1xuICAgICAgICAoPGFueT51aWV2ZW50KS52aWV3ID0gd2luZG93O1xuXG4gICAgICAgIGxldCB0YXJnZXQgOiBFbGVtZW50O1xuXG4gICAgICAgIHN3aXRjaCAodWlldmVudC50eXBlKSB7XG4gICAgICAgICAgICBjYXNlICd3aGVlbCc6XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh1aWV2ZW50LmNsaWVudFgsIHVpZXZlbnQuY2xpZW50WSkgfHwgd2luZG93O1xuICAgICAgICAgICAgICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBXaGVlbEV2ZW50KHVpZXZlbnQudHlwZSwgdWlldmVudCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbW91c2VsZWF2ZSc6XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh1aWV2ZW50LmNsaWVudFgsIHVpZXZlbnQuY2xpZW50WSkgfHwgd2luZG93O1xuICAgICAgICAgICAgICAgIGZpcmVNb3VzZUxlYXZlRXZlbnRzKGN1cnJlbnRNb3VzZVRhcmdldCwgdW5kZWZpbmVkLCB1aWV2ZW50KTtcbiAgICAgICAgICAgICAgICBjdXJyZW50TW91c2VUYXJnZXQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtb3VzZWVudGVyJzpcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHVpZXZlbnQuY2xpZW50WCwgdWlldmVudC5jbGllbnRZKSB8fCB3aW5kb3c7XG4gICAgICAgICAgICAgICAgZmlyZU1vdXNlRW50ZXJFdmVudHModGFyZ2V0LCB1bmRlZmluZWQsIHVpZXZlbnQpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRNb3VzZVRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ21vdXNlbW92ZSc6IFxuICAgICAgICAgICAgICAgIHRhcmdldCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQodWlldmVudC5jbGllbnRYLCB1aWV2ZW50LmNsaWVudFkpIHx8IHdpbmRvdztcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ICE9PSBjdXJyZW50TW91c2VUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyZU1vdXNlTGVhdmVFdmVudHMoY3VycmVudE1vdXNlVGFyZ2V0LCB0YXJnZXQsIHVpZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBmaXJlTW91c2VFbnRlckV2ZW50cyh0YXJnZXQsIGN1cnJlbnRNb3VzZVRhcmdldCwgdWlldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRNb3VzZVRhcmdldCA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IE1vdXNlRXZlbnQodWlldmVudC50eXBlLCB1aWV2ZW50KSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICd0b3VjaHN0YXJ0JzpcbiAgICAgICAgICAgICAgICBjb25zdCBwcmltYXJ5VG91Y2ggPSB1aWV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdO1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQocHJpbWFyeVRvdWNoLmNsaWVudFgsIHByaW1hcnlUb3VjaC5jbGllbnRZKSB8fCB3aW5kb3c7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mICg8VG91Y2hbXT48YW55PnVpZXZlbnQuY2hhbmdlZFRvdWNoZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdWNoVGFyZ2V0c1t0LmlkZW50aWZpZXJdID0gdGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICB0b3VjaFN0YXJ0VGltZXNbdC5pZGVudGlmaWVyXSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ3RvdWNobW92ZSc6XG4gICAgICAgICAgICBjYXNlICd0b3VjaGVuZCc6XG4gICAgICAgICAgICBjYXNlICd0b3VjaGNhbmNlbCc6XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdG91Y2hUYXJnZXRzW3VpZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uaWRlbnRpZmllcl07XG5cbiAgICAgICAgICAgICAgICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ1RvdWNoRXZlbnQnKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgdG91Y2hlcyA9IGRlc2VyaWFsaXplVG91Y2hlcyg8YW55PnVpZXZlbnQudG91Y2hlcywgdGFyZ2V0LCB1aWV2ZW50KTtcbiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0VG91Y2hlcyA9IGRlc2VyaWFsaXplVG91Y2hlcyg8YW55PnVpZXZlbnQudGFyZ2V0VG91Y2hlcywgdGFyZ2V0LCB1aWV2ZW50KTtcbiAgICAgICAgICAgICAgICBsZXQgY2hhbmdlZFRvdWNoZXMgPSBkZXNlcmlhbGl6ZVRvdWNoZXMoPGFueT51aWV2ZW50LmNoYW5nZWRUb3VjaGVzLCB0YXJnZXQsIHVpZXZlbnQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRvY3VtZW50LmNyZWF0ZVRvdWNoTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICB0b3VjaGVzID0gZG9jdW1lbnQuY3JlYXRlVG91Y2hMaXN0LmFwcGx5KGRvY3VtZW50LCB0b3VjaGVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0VG91Y2hlcyA9IGRvY3VtZW50LmNyZWF0ZVRvdWNoTGlzdC5hcHBseShkb2N1bWVudCwgdGFyZ2V0VG91Y2hlcyk7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWRUb3VjaGVzID0gZG9jdW1lbnQuY3JlYXRlVG91Y2hMaXN0LmFwcGx5KGRvY3VtZW50LCBjaGFuZ2VkVG91Y2hlcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNhZmFyaSwgRmlyZWZveDogbXVzdCB1c2UgaW5pdFRvdWNoRXZlbnQuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBldnRbJ2luaXRUb3VjaEV2ZW50J10gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBldnRbJ2luaXRUb3VjaEV2ZW50J10oXG4gICAgICAgICAgICAgICAgICAgICAgICB1aWV2ZW50LnR5cGUsIHVpZXZlbnQuYnViYmxlcywgdWlldmVudC5jYW5jZWxhYmxlLCB1aWV2ZW50LnZpZXcsIHVpZXZlbnQuZGV0YWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdWlldmVudC5zY3JlZW5YLCB1aWV2ZW50LnNjcmVlblksIHVpZXZlbnQuY2xpZW50WCwgdWlldmVudC5jbGllbnRZLFxuICAgICAgICAgICAgICAgICAgICAgICAgdWlldmVudC5jdHJsS2V5LCB1aWV2ZW50LmFsdEtleSwgdWlldmVudC5zaGlmdEtleSwgdWlldmVudC5tZXRhS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdG91Y2hlcywgdGFyZ2V0VG91Y2hlcywgY2hhbmdlZFRvdWNoZXMsIDEuMCwgMC4wXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgnVG91Y2hFdmVudCcgaW4gd2luZG93ICYmIFRvdWNoRXZlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWU6IG11c3QgdXNlIFRvdWNoRXZlbnQgY29uc3RydWN0b3IuXG4gICAgICAgICAgICAgICAgICAgIGV2dCA9IG5ldyAoPGFueT5Ub3VjaEV2ZW50KSh1aWV2ZW50LnR5cGUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbGFibGU6IHVpZXZlbnQuY2FuY2VsYWJsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1YmJsZXM6IHVpZXZlbnQuYnViYmxlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdWNoZXM6IHRvdWNoZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRUb3VjaGVzOiB0YXJnZXRUb3VjaGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZFRvdWNoZXM6IGNoYW5nZWRUb3VjaGVzXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGV2dC5pbml0VUlFdmVudCh1aWV2ZW50LnR5cGUsIHVpZXZlbnQuYnViYmxlcywgdWlldmVudC5jYW5jZWxhYmxlLCB1aWV2ZW50LnZpZXcsIHVpZXZlbnQuZGV0YWlsKTtcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+ZXZ0KS50b3VjaGVzID0gdG91Y2hlcztcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+ZXZ0KS50YXJnZXRUb3VjaGVzID0gdGFyZ2V0VG91Y2hlcztcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+ZXZ0KS5jaGFuZ2VkVG91Y2hlcyA9IGNoYW5nZWRUb3VjaGVzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh1aWV2ZW50LnR5cGUgPT09ICd0b3VjaGVuZCcgfHwgdWlldmVudC50eXBlID09ICd0b3VjaGNhbmNlbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZ0KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJpbWFyeVRvdWNoID0gY2hhbmdlZFRvdWNoZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICg8YW55PnVpZXZlbnQpLmNsaWVudFggPSBwcmltYXJ5VG91Y2guY2xpZW50WDtcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+dWlldmVudCkuY2xpZW50WSA9IHByaW1hcnlUb3VjaC5jbGllbnRZO1xuICAgICAgICAgICAgICAgICAgICAoPGFueT51aWV2ZW50KS5zY3JlZW5YID0gcHJpbWFyeVRvdWNoLnNjcmVlblg7XG4gICAgICAgICAgICAgICAgICAgICg8YW55PnVpZXZlbnQpLnNjcmVlblkgPSBwcmltYXJ5VG91Y2guc2NyZWVuWTtcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+dWlldmVudCkuYnV0dG9uID0gMDtcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+dWlldmVudCkuZGV0YWlsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVpZXZlbnQudHlwZSA9PT0gJ3RvdWNoZW5kJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBlcmZvcm1hbmNlLm5vdygpIC0gdG91Y2hTdGFydFRpbWVzW3ByaW1hcnlUb3VjaC5pZGVudGlmaWVyXSA8IDMwMCAmJiAhZXZ0LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudCgnbW91c2Vkb3duJywgdWlldmVudCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQobmV3IE1vdXNlRXZlbnQoJ21vdXNldXAnLCB1aWV2ZW50KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudCgnY2xpY2snLCB1aWV2ZW50KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KCdtb3VzZW91dCcsIHVpZXZlbnQpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiAoPFRvdWNoW10+PGFueT51aWV2ZW50LmNoYW5nZWRUb3VjaGVzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRvdWNoVGFyZ2V0c1t0LmlkZW50aWZpZXJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRvdWNoU3RhcnRUaW1lc1t0LmlkZW50aWZpZXJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRpc3BhdGNoRXZlbnQoZXZ0KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3BvaW50ZXJlbnRlcic6XG4gICAgICAgICAgICBjYXNlICdwb2ludGVybGVhdmUnOlxuICAgICAgICAgICAgY2FzZSAncG9pbnRlcm1vdmUnOlxuICAgICAgICAgICAgY2FzZSAncG9pbnRlcmNhbmNlbCc6XG4gICAgICAgICAgICBjYXNlICdwb2ludGVyZG93bic6XG4gICAgICAgICAgICBjYXNlICdwb2ludGVydXAnOiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzVGFyZ2V0ID0gcG9pbnRlclRhcmdldHNbdWlldmVudC5wb2ludGVySWRdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhcHR1cmVkVGFyZ2V0ID0gdGFyZ2V0ID0gY2FwdHVyZWRQb2ludGVyVGFyZ2V0c1t1aWV2ZW50LnBvaW50ZXJJZF07XG5cbiAgICAgICAgICAgICAgICBjb25zdCBpc0xlYXZpbmcgPSB1aWV2ZW50LnR5cGUgPT09ICdwb2ludGVybGVhdmUnIHx8IHVpZXZlbnQudHlwZSA9PT0gJ3BvaW50ZXJjYW5jZWwnO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcG9pbnRlckV2ZW50ID0gbmV3IFBvaW50ZXJFdmVudCh1aWV2ZW50LnR5cGUsIHVpZXZlbnQpO1xuICAgICAgICAgICAgICAgIGlmIChjYXB0dXJlZFRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICBjYXB0dXJlZFRhcmdldC5kaXNwYXRjaEV2ZW50KHBvaW50ZXJFdmVudCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh1aWV2ZW50LmNsaWVudFgsIHVpZXZlbnQuY2xpZW50WSkgfHwgd2luZG93O1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ICE9PSBwcmV2aW91c1RhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlyZVBvaW50ZXJMZWF2ZUV2ZW50cyhwcmV2aW91c1RhcmdldCwgdGFyZ2V0LCB1aWV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNMZWF2aW5nKSBmaXJlUG9pbnRlckVudGVyRXZlbnRzKHRhcmdldCwgcHJldmlvdXNUYXJnZXQsIHVpZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KHBvaW50ZXJFdmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChpc0xlYXZpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHBvaW50ZXJUYXJnZXRzW3VpZXZlbnQucG9pbnRlcklkXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwb2ludGVyVGFyZ2V0c1t1aWV2ZW50LnBvaW50ZXJJZF0gPSB0YXJnZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDogICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludCh1aWV2ZW50LmNsaWVudFgsIHVpZXZlbnQuY2xpZW50WSkgfHwgd2luZG93O1xuICAgICAgICAgICAgICAgIHRhcmdldC5kaXNwYXRjaEV2ZW50KG5ldyBNb3VzZUV2ZW50KHVpZXZlbnQudHlwZSwgdWlldmVudCkpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCkgPyBcbiAgICBnZXRFdmVudFN5bnRoZXNpemllciA6ICgpPT57IHJldHVybiB1bmRlZmluZWQ7IH07Il19