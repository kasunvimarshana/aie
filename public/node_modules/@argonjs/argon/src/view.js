var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import { autoinject, singleton } from 'aurelia-dependency-injection';
import { Viewport } from './common';
import { SessionService } from './session';
import { PerspectiveFrustum } from './cesium/cesium-imports';
import { Event, decomposePerspectiveProjectionMatrix, deprecated } from './utils';
import { FocusService, FocusServiceProvider } from './focus';
import { VisibilityServiceProvider } from './visibility';
/**
 * The rendering paramters for a particular subview
 */
var Subview = (function () {
    function Subview() {
    }
    return Subview;
}());
export { Subview };
var ViewItems = (function () {
    function ViewItems() {
    }
    ViewItems = __decorate([
        singleton()
    ], ViewItems);
    return ViewItems;
}());
export { ViewItems };
/**
 * Manages the view state
 */
var ViewService = (function () {
    function ViewService(sessionService, focusService, viewItems) {
        var _this = this;
        this.sessionService = sessionService;
        this.focusService = focusService;
        this.viewItems = viewItems;
        /**
         * UI events that occur within this view. To handle an event (and prevent it from
         * being forwarded to another layer) call event.stopImmediatePropagation().
         */
        this.uiEvent = new Event();
        /**
         * An event that is raised when the viewport has changed
         */
        this.viewportChangeEvent = new Event();
        /**
         * An event that is raised when the viewport mode has changed
         */
        this.viewportModeChangeEvent = new Event();
        this._mode = 0 /* EMBEDDED */;
        this._viewport = new Viewport;
        this._renderWidth = 0;
        this._renderHeight = 0;
        /**
         * Automatically layout the element to match the immersive viewport during PresentationMode.IMMERSIVE
         */
        this.autoLayoutImmersiveMode = true;
        /**
         * Automatically style layer elements
         */
        this.autoStyleLayerElements = true;
        /**
         * Automatically publish the viewport of the element during PresentationMode.EMBEDDED
         */
        this.autoPublishEmbeddedMode = true;
        this._subviews = [];
        this._subviewFrustum = [];
        this._desiredViewportMode = this.viewportMode;
        if (typeof document !== 'undefined' && document.createElement && !viewItems.element) {
            viewItems.element = document.createElement('div');
        }
        sessionService.manager.on['ar.view.viewportMode'] =
            function (_a) {
                var mode = _a.mode;
                _this._updateViewportMode(mode);
            };
        // if we are not the manager, we must start in immersive mode
        if (!sessionService.isRealityManager)
            this._updateViewportMode(1 /* IMMERSIVE */);
        sessionService.manager.connectEvent.addEventListener(function () {
            _this.viewportModeChangeEvent.raiseEvent(_this.viewportMode);
        });
    }
    Object.defineProperty(ViewService.prototype, "viewportMode", {
        /**
         * The current viewport mode
         */
        get: function () { return this._mode; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewService.prototype, "presentationMode", {
        get: function () { return this.viewportMode; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewService.prototype, "viewport", {
        /**
         * The current viewport
         */
        get: function () {
            return this._viewport;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewService.prototype, "renderWidth", {
        /**
         * The width which should be used for the render buffer
         */
        get: function () {
            return this._renderWidth;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewService.prototype, "renderHeight", {
        /**
         * The height which should be used for the render buffer
         */
        get: function () {
            return this._renderHeight;
        },
        enumerable: true,
        configurable: true
    });
    ViewService.prototype.getViewport = function () {
        return this.viewport;
    };
    ViewService.prototype.setLayers = function (layers) {
        var currentLayers = this.viewItems.layers;
        if (currentLayers) {
            for (var _i = 0, currentLayers_1 = currentLayers; _i < currentLayers_1.length; _i++) {
                var l = currentLayers_1[_i];
                this.element.removeChild(l.source);
            }
        }
        this.viewItems.layers = layers;
        for (var _a = 0, layers_1 = layers; _a < layers_1.length; _a++) {
            var l = layers_1[_a];
            this.element.appendChild(l.source);
        }
    };
    Object.defineProperty(ViewService.prototype, "element", {
        /**
        * The DOM element associated with this view
        */
        get: function () {
            return this.viewItems.element;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewService.prototype, "layers", {
        /**
         * The layers composing this view.
         */
        get: function () {
            return this.viewItems.layers;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewService.prototype, "subviews", {
        get: function () {
            return this._subviews;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @private
     */
    ViewService.prototype.getSubviews = function () {
        return this.subviews;
    };
    // Kind of hacky that we are passing the ContextService here.
    // Might be better to bring this logic into the ContextService
    ViewService.prototype._processContextFrameState = function (state, contextService) {
        var renderWidthScaleFactor = state.viewport.renderWidthScaleFactor || 1;
        var renderHeightScaleFactor = state.viewport.renderHeightScaleFactor || 1;
        this._renderWidth = state.viewport.width * renderWidthScaleFactor;
        this._renderHeight = state.viewport.height * renderHeightScaleFactor;
        var serializedSubviewList = state.subviews;
        var subviews = this._subviews;
        subviews.length = serializedSubviewList.length;
        var index = 0;
        for (var _i = 0, serializedSubviewList_1 = serializedSubviewList; _i < serializedSubviewList_1.length; _i++) {
            var serializedSubview = serializedSubviewList_1[_i];
            var subview = subviews[index] = subviews[index] || {};
            subview.index = index;
            subview.type = serializedSubview.type;
            subview.viewport = subview.viewport || {};
            subview.viewport.x = serializedSubview.viewport.x;
            subview.viewport.y = serializedSubview.viewport.y;
            subview.viewport.width = serializedSubview.viewport.width;
            subview.viewport.height = serializedSubview.viewport.height;
            subview.renderViewport = subview.renderViewport || {};
            subview.renderViewport.x = serializedSubview.viewport.x * renderWidthScaleFactor;
            subview.renderViewport.y = serializedSubview.viewport.y * renderHeightScaleFactor;
            subview.renderViewport.width = serializedSubview.viewport.width * renderWidthScaleFactor;
            subview.renderViewport.height = serializedSubview.viewport.height * renderHeightScaleFactor;
            subview.frustum = this._subviewFrustum[index] =
                this._subviewFrustum[index] || new PerspectiveFrustum();
            decomposePerspectiveProjectionMatrix(serializedSubview.projectionMatrix, subview.frustum);
            subview['projectionMatrix'] = subview.frustum.projectionMatrix;
            subview.pose = contextService.getEntityPose(contextService.getSubviewEntity(index));
            index++;
        }
        this._updateViewport(state.viewport);
    };
    ViewService.prototype.requestPresentationMode = function (mode) {
        return this.sessionService.manager.request('ar.view.desiredViewportMode', { mode: mode });
    };
    Object.defineProperty(ViewService.prototype, "desiredViewportMode", {
        get: function () {
            return this._desiredViewportMode;
        },
        set: function (mode) {
            var _this = this;
            this._desiredViewportMode = mode;
            this.sessionService.manager.whenConnected().then(function () {
                if (_this.sessionService.manager.version[0] > 0)
                    _this.sessionService.manager.send('ar.view.desiredViewportMode', { mode: mode });
            });
        },
        enumerable: true,
        configurable: true
    });
    ViewService.prototype._updateViewportMode = function (mode) {
        var currentMode = this.viewportMode;
        if (currentMode !== mode) {
            this._mode = mode;
            this.viewportModeChangeEvent.raiseEvent(mode);
        }
    };
    /**
     * Publish the viewport being used in [[PresentationMode.EMBEDDED]]
     * so that the manager knows what our embedded viewport is
     */
    ViewService.prototype.publishEmbeddedViewport = function (viewport) {
        if (this.sessionService.manager.isConnected &&
            this.sessionService.manager.version[0] >= 1)
            this.sessionService.manager.send('ar.view.embeddedViewport', { viewport: viewport });
    };
    // Updates the element, if necessary, and raise a view change event
    ViewService.prototype._updateViewport = function (viewport) {
        var viewportJSON = JSON.stringify(viewport);
        if (!this._currentViewportJSON || this._currentViewportJSON !== viewportJSON) {
            this._currentViewportJSON = viewportJSON;
            this._viewport = Viewport.clone(viewport, this._viewport);
            this.viewportChangeEvent.raiseEvent(viewport);
        }
    };
    ViewService.prototype.sendUIEventToSession = function (uievent, session) {
        if (session && session.isConnected)
            session.send('ar.view.uievent', uievent);
    };
    // private _embeddedViewport = new Viewport; 
    /**
     * @private
     */
    ViewService.prototype._watchEmbeddedViewport = function () {
        var _this = this;
        var publish = function () {
            // if (this.element && this.autoPublishEmbeddedMode) {
            //     const parentElement = this.element.parentElement;
            //     const rect = parentElement && parentElement.getBoundingClientRect();
            //     if (rect) {
            //         const x = rect.left;
            //         const y = window.innerHeight - rect.bottom;
            //         const width = rect.width;
            //         const height = rect.height;
            //         const embeddedViewport = this._embeddedViewport;
            //         if (embeddedViewport.x !== x || 
            //             embeddedViewport.y !== y || 
            //             embeddedViewport.width !== width ||
            //             embeddedViewport.height !== height) {
            //                 embeddedViewport.x = x;
            //                 embeddedViewport.y = y;
            //                 embeddedViewport.width = width;
            //                 embeddedViewport.height = height;
            //                 this.publishEmbeddedViewport(this._embeddedViewport);
            //         }
            //     }
            // }
        };
        setInterval(function () {
            if (!_this.focusService.hasFocus)
                publish();
        }, 500);
        // this.contextService.renderEvent.addEventListener(()=>{
        //     if (this.focusService.hasFocus) publish();
        // });
        if (typeof window !== 'undefined' && window.addEventListener) {
            window.addEventListener('orientationchange', publish);
            window.addEventListener('scroll', publish);
            this.sessionService.manager.closeEvent.addEventListener(function () {
                window.removeEventListener('orientationchange', publish);
                window.removeEventListener('scroll', publish);
            });
        }
    };
    __decorate([
        deprecated('viewportMode'),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [])
    ], ViewService.prototype, "presentationMode", null);
    __decorate([
        deprecated('viewport'),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", []),
        __metadata("design:returntype", void 0)
    ], ViewService.prototype, "getViewport", null);
    __decorate([
        deprecated('subviews'),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", []),
        __metadata("design:returntype", void 0)
    ], ViewService.prototype, "getSubviews", null);
    __decorate([
        deprecated('desiredViewportMode'),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Number]),
        __metadata("design:returntype", Promise)
    ], ViewService.prototype, "requestPresentationMode", null);
    ViewService = __decorate([
        autoinject,
        __metadata("design:paramtypes", [SessionService,
            FocusService,
            ViewItems])
    ], ViewService);
    return ViewService;
}());
export { ViewService };
var ViewServiceProvider = (function () {
    function ViewServiceProvider(sessionService, viewService, focusServiceProvider, visibilityServiceProvider) {
        var _this = this;
        this.sessionService = sessionService;
        this.viewService = viewService;
        this.focusServiceProvider = focusServiceProvider;
        this.sessionViewportMode = new WeakMap();
        /**
         * The embedded viewports for each managed session.
         */
        this.sessionEmbeddedViewport = new WeakMap();
        /**
         * A UI event being forwarded from a managed session
         */
        this.forwardedUIEvent = new Event();
        sessionService.ensureIsRealityManager();
        sessionService.connectEvent.addEventListener(function (session) {
            _this.sessionViewportMode.set(session, session === _this.sessionService.manager ?
                _this.viewService.desiredViewportMode :
                1 /* IMMERSIVE */);
            // forward ui events to the visible reality viewer
            session.on['ar.view.forwardUIEvent'] = function (uievent) {
                _this.forwardedUIEvent.raiseEvent(uievent);
            };
            session.on['ar.view.desiredViewportMode'] = function (_a) {
                var mode = _a.mode;
                _this.sessionViewportMode.set(session, mode);
                _this._publishViewportModes();
            };
            session.on['ar.view.embeddedViewport'] = function (viewport) {
                _this.sessionEmbeddedViewport.set(session, viewport);
            };
            _this._publishViewportModes();
        });
        focusServiceProvider.sessionFocusEvent.addEventListener(function () {
            _this._publishViewportModes();
        });
    }
    ViewServiceProvider.prototype.sendUIEventToSession = function (uievent, session) {
        session.send('ar.view.uievent', uievent);
    };
    ViewServiceProvider.prototype._publishViewportModes = function () {
        this.sessionService.manager.send('ar.view.viewportMode', {
            mode: this.sessionViewportMode.get(this.sessionService.manager)
        });
        for (var _i = 0, _a = this.sessionService.managedSessions; _i < _a.length; _i++) {
            var session = _a[_i];
            var mode = (session === this.focusServiceProvider.session) ?
                this.sessionViewportMode.get(session) : 1 /* IMMERSIVE */;
            if (session.version[0] > 0)
                session.send('ar.view.viewportMode', { mode: mode });
        }
    };
    ViewServiceProvider = __decorate([
        autoinject(),
        __metadata("design:paramtypes", [SessionService,
            ViewService,
            FocusServiceProvider,
            VisibilityServiceProvider])
    ], ViewServiceProvider);
    return ViewServiceProvider;
}());
export { ViewServiceProvider };
// setup our DOM environment
if (typeof document !== 'undefined' && document.createElement) {
    var viewportMetaTag = document.querySelector('meta[name=viewport]');
    if (!viewportMetaTag)
        viewportMetaTag = document.createElement('meta');
    viewportMetaTag.name = 'viewport';
    viewportMetaTag.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0';
    document.head.appendChild(viewportMetaTag);
    var argonMetaTag = document.querySelector('meta[name=argon]');
    if (!argonMetaTag)
        argonMetaTag = document.createElement('meta');
    argonMetaTag.name = 'argon';
    document.head.appendChild(argonMetaTag);
    var style = document.createElement("style");
    style.type = 'text/css';
    document.head.insertBefore(style, document.head.firstChild);
    var sheet = style.sheet;
    sheet.insertRule("\n        #argon {\n            position: fixed;\n            width: 100%;\n            height: 100%;\n            left: 0;\n            bottom: 0;\n            margin: 0;\n            border: 0;\n            padding: 0;\n        }\n    ", sheet.cssRules.length);
    sheet.insertRule("\n        .argon-view {\n            -webkit-tap-highlight-color: transparent;\n            -webkit-user-select: none;\n            user-select: none;\n        }\n    ", sheet.cssRules.length);
    sheet.insertRule("\n        .argon-immersive .argon-view {\n            position: fixed !important;\n            width: 100% !important;\n            height: 100% !important;\n            max-width: 100% !important;\n            max-height: 100% !important;\n            left: 0;\n            bottom: 0;\n            margin: 0;\n            border: 0;\n            padding: 0;\n            visibility: visible;\n        }\n    ", sheet.cssRules.length);
    sheet.insertRule("\n        :not(.argon-reality-manager).argon-immersive body {\n            visibility: hidden;\n        }\n    ", sheet.cssRules.length);
    sheet.insertRule("\n        .argon-interactive {\n            pointer-events: auto;\n        }\n    ", sheet.cssRules.length);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlldy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInZpZXcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQTtBQUNwRSxPQUFPLEVBQWtCLFFBQVEsRUFBa0MsTUFBTSxVQUFVLENBQUE7QUFDbkYsT0FBTyxFQUFFLGNBQWMsRUFBZSxNQUFNLFdBQVcsQ0FBQTtBQUl2RCxPQUFPLEVBQUUsa0JBQWtCLEVBQVcsTUFBTSx5QkFBeUIsQ0FBQTtBQUVyRSxPQUFPLEVBQ0gsS0FBSyxFQUNMLG9DQUFvQyxFQUNwQyxVQUFVLEVBQ2IsTUFBTSxTQUFTLENBQUE7QUFFaEIsT0FBTyxFQUFFLFlBQVksRUFBRSxvQkFBb0IsRUFBRSxNQUFNLFNBQVMsQ0FBQTtBQUM1RCxPQUFPLEVBQUUseUJBQXlCLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFFeEQ7O0dBRUc7QUFDSDtJQUFBO0lBT0EsQ0FBQztJQUFELGNBQUM7QUFBRCxDQUFDLEFBUEQsSUFPQzs7QUFTRDtJQUFBO0lBR0EsQ0FBQztJQUhZLFNBQVM7UUFEckIsU0FBUyxFQUFFO09BQ0MsU0FBUyxDQUdyQjtJQUFELGdCQUFDO0NBQUEsQUFIRCxJQUdDO1NBSFksU0FBUztBQUt0Qjs7R0FFRztBQUVIO0lBdUVJLHFCQUNZLGNBQThCLEVBQzlCLFlBQTBCLEVBQzFCLFNBQW9CO1FBSGhDLGlCQXNCQztRQXJCVyxtQkFBYyxHQUFkLGNBQWMsQ0FBZ0I7UUFDOUIsaUJBQVksR0FBWixZQUFZLENBQWM7UUFDMUIsY0FBUyxHQUFULFNBQVMsQ0FBVztRQXhFaEM7OztXQUdHO1FBQ0ksWUFBTyxHQUFHLElBQUksS0FBSyxFQUF3RixDQUFDO1FBRW5IOztXQUVHO1FBQ0ksd0JBQW1CLEdBQUcsSUFBSSxLQUFLLEVBQWtCLENBQUM7UUFFekQ7O1dBRUc7UUFDSSw0QkFBdUIsR0FBRyxJQUFJLEtBQUssRUFBZ0Is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QyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDOUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGF1dG9pbmplY3QsIHNpbmdsZXRvbiB9IGZyb20gJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nXG5pbXBvcnQgeyBDYW52YXNWaWV3cG9ydCwgVmlld3BvcnQsIENvbnRleHRGcmFtZVN0YXRlLCBTdWJ2aWV3VHlwZSB9IGZyb20gJy4vY29tbW9uJ1xuaW1wb3J0IHsgU2Vzc2lvblNlcnZpY2UsIFNlc3Npb25Qb3J0IH0gZnJvbSAnLi9zZXNzaW9uJ1xuaW1wb3J0IHsgQ29udGV4dFNlcnZpY2UgfSBmcm9tICcuL2NvbnRleHQnXG5pbXBvcnQgeyBFbnRpdHlQb3NlIH0gZnJvbSAnLi9lbnRpdHknXG5cbmltcG9ydCB7IFBlcnNwZWN0aXZlRnJ1c3R1bSwgTWF0cml4NCB9IGZyb20gJy4vY2VzaXVtL2Nlc2l1bS1pbXBvcnRzJ1xuXG5pbXBvcnQgeyBcbiAgICBFdmVudCxcbiAgICBkZWNvbXBvc2VQZXJzcGVjdGl2ZVByb2plY3Rpb25NYXRyaXgsXG4gICAgZGVwcmVjYXRlZFxufSBmcm9tICcuL3V0aWxzJ1xuXG5pbXBvcnQgeyBGb2N1c1NlcnZpY2UsIEZvY3VzU2VydmljZVByb3ZpZGVyIH0gZnJvbSAnLi9mb2N1cydcbmltcG9ydCB7IFZpc2liaWxpdHlTZXJ2aWNlUHJvdmlkZXIgfSBmcm9tICcuL3Zpc2liaWxpdHknXG5cbi8qKlxuICogVGhlIHJlbmRlcmluZyBwYXJhbXRlcnMgZm9yIGEgcGFydGljdWxhciBzdWJ2aWV3XG4gKi9cbmV4cG9ydCBjbGFzcyBTdWJ2aWV3IHtcbiAgICBpbmRleDogbnVtYmVyO1xuICAgIHR5cGU6IFN1YnZpZXdUeXBlO1xuICAgIGZydXN0dW06IFBlcnNwZWN0aXZlRnJ1c3R1bTtcbiAgICBwb3NlOiBFbnRpdHlQb3NlO1xuICAgIHZpZXdwb3J0OiBWaWV3cG9ydDtcbiAgICByZW5kZXJWaWV3cG9ydDogVmlld3BvcnQ7XG59XG5cbmV4cG9ydCBjb25zdCBlbnVtIFZpZXdwb3J0TW9kZSB7XG4gICAgRU1CRURERUQgPSAwLFxuICAgIFBBR0UgPSAwLCAvLyBhbGlhcyBmb3IgRU1CRURERURcbiAgICBJTU1FUlNJVkVcbn1cblxuQHNpbmdsZXRvbigpXG5leHBvcnQgY2xhc3MgVmlld0l0ZW1zIHtcbiAgICBwdWJsaWMgZWxlbWVudD86IEhUTUxFbGVtZW50O1xuICAgIHB1YmxpYyBsYXllcnM/OiB7c291cmNlOiBIVE1MRWxlbWVudH1bXTtcbn1cblxuLyoqXG4gKiBNYW5hZ2VzIHRoZSB2aWV3IHN0YXRlXG4gKi9cbkBhdXRvaW5qZWN0XG5leHBvcnQgY2xhc3MgVmlld1NlcnZpY2Uge1xuICAgIFxuICAgIC8qKlxuICAgICAqIFVJIGV2ZW50cyB0aGF0IG9jY3VyIHdpdGhpbiB0aGlzIHZpZXcuIFRvIGhhbmRsZSBhbiBldmVudCAoYW5kIHByZXZlbnQgaXQgZnJvbVxuICAgICAqIGJlaW5nIGZvcndhcmRlZCB0byBhbm90aGVyIGxheWVyKSBjYWxsIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLlxuICAgICAqL1xuICAgIHB1YmxpYyB1aUV2ZW50ID0gbmV3IEV2ZW50PHtldmVudDpVSUV2ZW50fE1vdXNlRXZlbnR8VG91Y2hFdmVudHxQb2ludGVyRXZlbnR8V2hlZWxFdmVudCwgZm9yd2FyZEV2ZW50OigpPT52b2lkfT4oKTtcblxuICAgIC8qKlxuICAgICAqIEFuIGV2ZW50IHRoYXQgaXMgcmFpc2VkIHdoZW4gdGhlIHZpZXdwb3J0IGhhcyBjaGFuZ2VkXG4gICAgICovXG4gICAgcHVibGljIHZpZXdwb3J0Q2hhbmdlRXZlbnQgPSBuZXcgRXZlbnQ8Q2FudmFzVmlld3BvcnQ+KCk7XG5cbiAgICAvKipcbiAgICAgKiBBbiBldmVudCB0aGF0IGlzIHJhaXNlZCB3aGVuIHRoZSB2aWV3cG9ydCBtb2RlIGhhcyBjaGFuZ2VkXG4gICAgICovXG4gICAgcHVibGljIHZpZXdwb3J0TW9kZUNoYW5nZUV2ZW50ID0gbmV3IEV2ZW50PFZpZXdwb3J0TW9kZT4oKTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50IHZpZXdwb3J0IG1vZGVcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHZpZXdwb3J0TW9kZSgpIHsgcmV0dXJuIHRoaXMuX21vZGUgfVxuICAgIHByaXZhdGUgX21vZGUgPSBWaWV3cG9ydE1vZGUuRU1CRURERUQ7XG5cbiAgICBAZGVwcmVjYXRlZCgndmlld3BvcnRNb2RlJylcbiAgICBwcm90ZWN0ZWQgZ2V0IHByZXNlbnRhdGlvbk1vZGUoKSB7IHJldHVybiB0aGlzLnZpZXdwb3J0TW9kZSB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudCB2aWV3cG9ydFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgdmlld3BvcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl92aWV3cG9ydDtcbiAgICB9XG4gICAgcHJpdmF0ZSBfdmlld3BvcnQgPSBuZXcgVmlld3BvcnQ7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggd2hpY2ggc2hvdWxkIGJlIHVzZWQgZm9yIHRoZSByZW5kZXIgYnVmZmVyXG4gICAgICovXG4gICAgcHVibGljIGdldCByZW5kZXJXaWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlbmRlcldpZHRoO1xuICAgIH1cbiAgICBwcml2YXRlIF9yZW5kZXJXaWR0aCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaGVpZ2h0IHdoaWNoIHNob3VsZCBiZSB1c2VkIGZvciB0aGUgcmVuZGVyIGJ1ZmZlclxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgcmVuZGVySGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVySGVpZ2h0O1xuICAgIH1cbiAgICBwcml2YXRlIF9yZW5kZXJIZWlnaHQgPSAwO1xuICAgIFxuICAgIEBkZXByZWNhdGVkKCd2aWV3cG9ydCcpXG4gICAgcHVibGljIGdldFZpZXdwb3J0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3cG9ydDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBdXRvbWF0aWNhbGx5IGxheW91dCB0aGUgZWxlbWVudCB0byBtYXRjaCB0aGUgaW1tZXJzaXZlIHZpZXdwb3J0IGR1cmluZyBQcmVzZW50YXRpb25Nb2RlLklNTUVSU0lWRVxuICAgICAqL1xuICAgIHB1YmxpYyBhdXRvTGF5b3V0SW1tZXJzaXZlTW9kZSA9IHRydWU7XG5cbiAgICAvKipcbiAgICAgKiBBdXRvbWF0aWNhbGx5IHN0eWxlIGxheWVyIGVsZW1lbnRzXG4gICAgICovXG4gICAgcHVibGljIGF1dG9TdHlsZUxheWVyRWxlbWVudHMgPSB0cnVlO1xuXG4gICAgLyoqXG4gICAgICogQXV0b21hdGljYWxseSBwdWJsaXNoIHRoZSB2aWV3cG9ydCBvZiB0aGUgZWxlbWVudCBkdXJpbmcgUHJlc2VudGF0aW9uTW9kZS5FTUJFRERFRFxuICAgICAqL1xuICAgIHB1YmxpYyBhdXRvUHVibGlzaEVtYmVkZGVkTW9kZSA9IHRydWU7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBzZXNzaW9uU2VydmljZTogU2Vzc2lvblNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgZm9jdXNTZXJ2aWNlOiBGb2N1c1NlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgdmlld0l0ZW1zOiBWaWV3SXRlbXNcbiAgICAgICApIHtcblxuICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBkb2N1bWVudC5jcmVhdGVFbGVtZW50ICYmICF2aWV3SXRlbXMuZWxlbWVudCkge1xuICAgICAgICAgICAgdmlld0l0ZW1zLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlc3Npb25TZXJ2aWNlLm1hbmFnZXIub25bJ2FyLnZpZXcudmlld3BvcnRNb2RlJ10gPSBcbiAgICAgICAgICAgICh7bW9kZX06e21vZGU6Vmlld3BvcnRNb2RlfSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVZpZXdwb3J0TW9kZShtb2RlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAvLyBpZiB3ZSBhcmUgbm90IHRoZSBtYW5hZ2VyLCB3ZSBtdXN0IHN0YXJ0IGluIGltbWVyc2l2ZSBtb2RlXG4gICAgICAgIGlmICghc2Vzc2lvblNlcnZpY2UuaXNSZWFsaXR5TWFuYWdlcilcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVZpZXdwb3J0TW9kZShWaWV3cG9ydE1vZGUuSU1NRVJTSVZFKTtcblxuICAgICAgICBzZXNzaW9uU2VydmljZS5tYW5hZ2VyLmNvbm5lY3RFdmVudC5hZGRFdmVudExpc3RlbmVyKCgpPT57XG4gICAgICAgICAgICB0aGlzLnZpZXdwb3J0TW9kZUNoYW5nZUV2ZW50LnJhaXNlRXZlbnQodGhpcy52aWV3cG9ydE1vZGUpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBzZXRMYXllcnMobGF5ZXJzOntzb3VyY2U6SFRNTEVsZW1lbnR9W10pIHtcbiAgICAgICAgY29uc3QgY3VycmVudExheWVycyA9IHRoaXMudmlld0l0ZW1zLmxheWVycztcbiAgICAgICAgaWYgKGN1cnJlbnRMYXllcnMpIHsgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGwgb2YgY3VycmVudExheWVycykge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCEucmVtb3ZlQ2hpbGQobC5zb3VyY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudmlld0l0ZW1zLmxheWVycyA9IGxheWVycztcbiAgICAgICAgZm9yIChjb25zdCBsIG9mIGxheWVycykge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50IS5hcHBlbmRDaGlsZChsLnNvdXJjZSk7XG4gICAgICAgIH1cbiAgICB9ICAgIFxuICAgIFxuICAgICAvKipcbiAgICAgKiBUaGUgRE9NIGVsZW1lbnQgYXNzb2NpYXRlZCB3aXRoIHRoaXMgdmlld1xuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZWxlbWVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld0l0ZW1zLmVsZW1lbnQhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBsYXllcnMgY29tcG9zaW5nIHRoaXMgdmlldy4gXG4gICAgICovXG4gICAgcHVibGljIGdldCBsYXllcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdJdGVtcy5sYXllcnM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY3VycmVudFZpZXdwb3J0SlNPTjogc3RyaW5nO1xuXG4gICAgcHJpdmF0ZSBfc3Vidmlld3M6IFN1YnZpZXdbXSA9IFtdO1xuICAgIHByaXZhdGUgX3N1YnZpZXdGcnVzdHVtOiBQZXJzcGVjdGl2ZUZydXN0dW1bXSA9IFtdO1xuXG4gICAgcHVibGljIGdldCBzdWJ2aWV3cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1YnZpZXdzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgQGRlcHJlY2F0ZWQoJ3N1YnZpZXdzJylcbiAgICBwcm90ZWN0ZWQgZ2V0U3Vidmlld3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YnZpZXdzO1xuICAgIH1cblxuICAgIC8vIEtpbmQgb2YgaGFja3kgdGhhdCB3ZSBhcmUgcGFzc2luZyB0aGUgQ29udGV4dFNlcnZpY2UgaGVyZS5cbiAgICAvLyBNaWdodCBiZSBiZXR0ZXIgdG8gYnJpbmcgdGhpcyBsb2dpYyBpbnRvIHRoZSBDb250ZXh0U2VydmljZVxuICAgIHB1YmxpYyBfcHJvY2Vzc0NvbnRleHRGcmFtZVN0YXRlKHN0YXRlOkNvbnRleHRGcmFtZVN0YXRlLCBjb250ZXh0U2VydmljZTpDb250ZXh0U2VydmljZSkge1xuXG4gICAgICAgIGNvbnN0IHJlbmRlcldpZHRoU2NhbGVGYWN0b3IgPSBzdGF0ZS52aWV3cG9ydC5yZW5kZXJXaWR0aFNjYWxlRmFjdG9yIHx8IDE7XG4gICAgICAgIGNvbnN0IHJlbmRlckhlaWdodFNjYWxlRmFjdG9yID0gc3RhdGUudmlld3BvcnQucmVuZGVySGVpZ2h0U2NhbGVGYWN0b3IgfHwgMTtcbiAgICAgICAgdGhpcy5fcmVuZGVyV2lkdGggPSBzdGF0ZS52aWV3cG9ydC53aWR0aCAqIHJlbmRlcldpZHRoU2NhbGVGYWN0b3I7XG4gICAgICAgIHRoaXMuX3JlbmRlckhlaWdodCA9IHN0YXRlLnZpZXdwb3J0LmhlaWdodCAqIHJlbmRlckhlaWdodFNjYWxlRmFjdG9yO1xuXG4gICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRTdWJ2aWV3TGlzdCA9IHN0YXRlLnN1YnZpZXdzO1xuICAgICAgICBjb25zdCBzdWJ2aWV3czogU3Vidmlld1tdID0gdGhpcy5fc3Vidmlld3M7XG4gICAgICAgIHN1YnZpZXdzLmxlbmd0aCA9IHNlcmlhbGl6ZWRTdWJ2aWV3TGlzdC5sZW5ndGg7XG5cbiAgICAgICAgbGV0IGluZGV4ID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBzZXJpYWxpemVkU3VidmlldyBvZiBzZXJpYWxpemVkU3Vidmlld0xpc3QpIHtcblxuICAgICAgICAgICAgY29uc3Qgc3VidmlldyA9IHN1YnZpZXdzW2luZGV4XSA9IHN1YnZpZXdzW2luZGV4XSB8fCA8U3Vidmlldz57fTtcbiAgICAgICAgICAgIHN1YnZpZXcuaW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgIHN1YnZpZXcudHlwZSA9IHNlcmlhbGl6ZWRTdWJ2aWV3LnR5cGU7XG5cbiAgICAgICAgICAgIHN1YnZpZXcudmlld3BvcnQgPSBzdWJ2aWV3LnZpZXdwb3J0IHx8IHt9O1xuICAgICAgICAgICAgc3Vidmlldy52aWV3cG9ydC54ID0gc2VyaWFsaXplZFN1YnZpZXcudmlld3BvcnQueDtcbiAgICAgICAgICAgIHN1YnZpZXcudmlld3BvcnQueSA9IHNlcmlhbGl6ZWRTdWJ2aWV3LnZpZXdwb3J0Lnk7XG4gICAgICAgICAgICBzdWJ2aWV3LnZpZXdwb3J0LndpZHRoID0gc2VyaWFsaXplZFN1YnZpZXcudmlld3BvcnQud2lkdGg7XG4gICAgICAgICAgICBzdWJ2aWV3LnZpZXdwb3J0LmhlaWdodCA9IHNlcmlhbGl6ZWRTdWJ2aWV3LnZpZXdwb3J0LmhlaWdodDtcbiAgICAgICAgICAgIHN1YnZpZXcucmVuZGVyVmlld3BvcnQgPSBzdWJ2aWV3LnJlbmRlclZpZXdwb3J0IHx8IHt9O1xuICAgICAgICAgICAgc3Vidmlldy5yZW5kZXJWaWV3cG9ydC54ID0gc2VyaWFsaXplZFN1YnZpZXcudmlld3BvcnQueCAqIHJlbmRlcldpZHRoU2NhbGVGYWN0b3I7XG4gICAgICAgICAgICBzdWJ2aWV3LnJlbmRlclZpZXdwb3J0LnkgPSBzZXJpYWxpemVkU3Vidmlldy52aWV3cG9ydC55ICogcmVuZGVySGVpZ2h0U2NhbGVGYWN0b3I7XG4gICAgICAgICAgICBzdWJ2aWV3LnJlbmRlclZpZXdwb3J0LndpZHRoID0gc2VyaWFsaXplZFN1YnZpZXcudmlld3BvcnQud2lkdGggKiByZW5kZXJXaWR0aFNjYWxlRmFjdG9yO1xuICAgICAgICAgICAgc3Vidmlldy5yZW5kZXJWaWV3cG9ydC5oZWlnaHQgPSBzZXJpYWxpemVkU3Vidmlldy52aWV3cG9ydC5oZWlnaHQgKiByZW5kZXJIZWlnaHRTY2FsZUZhY3RvcjtcblxuICAgICAgICAgICAgc3Vidmlldy5mcnVzdHVtID0gdGhpcy5fc3Vidmlld0ZydXN0dW1baW5kZXhdID0gXG4gICAgICAgICAgICAgICAgdGhpcy5fc3Vidmlld0ZydXN0dW1baW5kZXhdIHx8IG5ldyBQZXJzcGVjdGl2ZUZydXN0dW0oKTtcbiAgICAgICAgICAgIGRlY29tcG9zZVBlcnNwZWN0aXZlUHJvamVjdGlvbk1hdHJpeChzZXJpYWxpemVkU3Vidmlldy5wcm9qZWN0aW9uTWF0cml4LCBzdWJ2aWV3LmZydXN0dW0pO1xuICAgICAgICAgICAgc3Vidmlld1sncHJvamVjdGlvbk1hdHJpeCddID0gPE1hdHJpeDQ+c3Vidmlldy5mcnVzdHVtLnByb2plY3Rpb25NYXRyaXg7XG5cbiAgICAgICAgICAgIHN1YnZpZXcucG9zZSA9IGNvbnRleHRTZXJ2aWNlLmdldEVudGl0eVBvc2UoY29udGV4dFNlcnZpY2UuZ2V0U3Vidmlld0VudGl0eShpbmRleCkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fdXBkYXRlVmlld3BvcnQoc3RhdGUudmlld3BvcnQpO1xuICAgIH1cblxuICAgIEBkZXByZWNhdGVkKCdkZXNpcmVkVmlld3BvcnRNb2RlJylcbiAgICBwdWJsaWMgcmVxdWVzdFByZXNlbnRhdGlvbk1vZGUobW9kZTpWaWV3cG9ydE1vZGUpIDogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIucmVxdWVzdCgnYXIudmlldy5kZXNpcmVkVmlld3BvcnRNb2RlJywge21vZGV9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9kZXNpcmVkVmlld3BvcnRNb2RlOlZpZXdwb3J0TW9kZSA9IHRoaXMudmlld3BvcnRNb2RlO1xuXG4gICAgcHVibGljIHNldCBkZXNpcmVkVmlld3BvcnRNb2RlKG1vZGU6Vmlld3BvcnRNb2RlKSB7XG4gICAgICAgIHRoaXMuX2Rlc2lyZWRWaWV3cG9ydE1vZGUgPSBtb2RlO1xuICAgICAgICB0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIud2hlbkNvbm5lY3RlZCgpLnRoZW4oKCk9PntcbiAgICAgICAgICAgIGlmICh0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIudmVyc2lvblswXSA+IDApXG4gICAgICAgICAgICAgICAgdGhpcy5zZXNzaW9uU2VydmljZS5tYW5hZ2VyLnNlbmQoJ2FyLnZpZXcuZGVzaXJlZFZpZXdwb3J0TW9kZScsIHttb2RlfSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGdldCBkZXNpcmVkVmlld3BvcnRNb2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGVzaXJlZFZpZXdwb3J0TW9kZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF91cGRhdGVWaWV3cG9ydE1vZGUobW9kZTpWaWV3cG9ydE1vZGUpIHtcbiAgICAgICAgY29uc3QgY3VycmVudE1vZGUgPSB0aGlzLnZpZXdwb3J0TW9kZTtcbiAgICAgICAgaWYgKGN1cnJlbnRNb2RlICE9PSBtb2RlKSB7XG4gICAgICAgICAgICB0aGlzLl9tb2RlID0gbW9kZTtcbiAgICAgICAgICAgIHRoaXMudmlld3BvcnRNb2RlQ2hhbmdlRXZlbnQucmFpc2VFdmVudChtb2RlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFB1Ymxpc2ggdGhlIHZpZXdwb3J0IGJlaW5nIHVzZWQgaW4gW1tQcmVzZW50YXRpb25Nb2RlLkVNQkVEREVEXV0gXG4gICAgICogc28gdGhhdCB0aGUgbWFuYWdlciBrbm93cyB3aGF0IG91ciBlbWJlZGRlZCB2aWV3cG9ydCBpc1xuICAgICAqL1xuICAgIHB1YmxpYyBwdWJsaXNoRW1iZWRkZWRWaWV3cG9ydCh2aWV3cG9ydD86IFZpZXdwb3J0KSB7XG4gICAgICAgIGlmICh0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIuaXNDb25uZWN0ZWQgJiYgXG4gICAgICAgICAgICB0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIudmVyc2lvblswXSA+PSAxKSBcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvblNlcnZpY2UubWFuYWdlci5zZW5kKCdhci52aWV3LmVtYmVkZGVkVmlld3BvcnQnLCB7dmlld3BvcnR9KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGVzIHRoZSBlbGVtZW50LCBpZiBuZWNlc3NhcnksIGFuZCByYWlzZSBhIHZpZXcgY2hhbmdlIGV2ZW50XG4gICAgcHJpdmF0ZSBfdXBkYXRlVmlld3BvcnQodmlld3BvcnQ6Q2FudmFzVmlld3BvcnQpIHtcbiAgICAgICAgY29uc3Qgdmlld3BvcnRKU09OID0gSlNPTi5zdHJpbmdpZnkodmlld3BvcnQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLl9jdXJyZW50Vmlld3BvcnRKU09OIHx8IHRoaXMuX2N1cnJlbnRWaWV3cG9ydEpTT04gIT09IHZpZXdwb3J0SlNPTikge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFZpZXdwb3J0SlNPTiA9IHZpZXdwb3J0SlNPTjtcblxuICAgICAgICAgICAgdGhpcy5fdmlld3BvcnQgPSBWaWV3cG9ydC5jbG9uZSh2aWV3cG9ydCwgdGhpcy5fdmlld3BvcnQpITtcblxuICAgICAgICAgICAgdGhpcy52aWV3cG9ydENoYW5nZUV2ZW50LnJhaXNlRXZlbnQodmlld3BvcnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHNlbmRVSUV2ZW50VG9TZXNzaW9uKHVpZXZlbnQ6VUlFdmVudCwgc2Vzc2lvbj86U2Vzc2lvblBvcnQpIHtcbiAgICAgICAgaWYgKHNlc3Npb24gJiYgc2Vzc2lvbi5pc0Nvbm5lY3RlZCkgc2Vzc2lvbi5zZW5kKCdhci52aWV3LnVpZXZlbnQnLCB1aWV2ZW50KTtcbiAgICB9XG5cbiAgICAvLyBwcml2YXRlIF9lbWJlZGRlZFZpZXdwb3J0ID0gbmV3IFZpZXdwb3J0OyBcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgcHVibGljIF93YXRjaEVtYmVkZGVkVmlld3BvcnQoKSB7XG4gICAgICAgIGNvbnN0IHB1Ymxpc2ggPSAoKSA9PiB7XG4gICAgICAgICAgICAvLyBpZiAodGhpcy5lbGVtZW50ICYmIHRoaXMuYXV0b1B1Ymxpc2hFbWJlZGRlZE1vZGUpIHtcbiAgICAgICAgICAgIC8vICAgICBjb25zdCBwYXJlbnRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICAvLyAgICAgY29uc3QgcmVjdCA9IHBhcmVudEVsZW1lbnQgJiYgcGFyZW50RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIC8vICAgICBpZiAocmVjdCkge1xuICAgICAgICAgICAgLy8gICAgICAgICBjb25zdCB4ID0gcmVjdC5sZWZ0O1xuICAgICAgICAgICAgLy8gICAgICAgICBjb25zdCB5ID0gd2luZG93LmlubmVySGVpZ2h0IC0gcmVjdC5ib3R0b207XG4gICAgICAgICAgICAvLyAgICAgICAgIGNvbnN0IHdpZHRoID0gcmVjdC53aWR0aDtcbiAgICAgICAgICAgIC8vICAgICAgICAgY29uc3QgaGVpZ2h0ID0gcmVjdC5oZWlnaHQ7XG5cbiAgICAgICAgICAgIC8vICAgICAgICAgY29uc3QgZW1iZWRkZWRWaWV3cG9ydCA9IHRoaXMuX2VtYmVkZGVkVmlld3BvcnQ7XG5cbiAgICAgICAgICAgIC8vICAgICAgICAgaWYgKGVtYmVkZGVkVmlld3BvcnQueCAhPT0geCB8fCBcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVtYmVkZGVkVmlld3BvcnQueSAhPT0geSB8fCBcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIGVtYmVkZGVkVmlld3BvcnQud2lkdGggIT09IHdpZHRoIHx8XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICBlbWJlZGRlZFZpZXdwb3J0LmhlaWdodCAhPT0gaGVpZ2h0KSB7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgZW1iZWRkZWRWaWV3cG9ydC54ID0geDtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBlbWJlZGRlZFZpZXdwb3J0LnkgPSB5O1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGVtYmVkZGVkVmlld3BvcnQud2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBlbWJlZGRlZFZpZXdwb3J0LmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLnB1Ymxpc2hFbWJlZGRlZFZpZXdwb3J0KHRoaXMuX2VtYmVkZGVkVmlld3BvcnQpO1xuICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAvLyAgICAgfVxuICAgICAgICAgICAgLy8gfVxuICAgICAgICB9XG5cbiAgICAgICAgc2V0SW50ZXJ2YWwoKCk9PntcbiAgICAgICAgICAgIGlmICghdGhpcy5mb2N1c1NlcnZpY2UuaGFzRm9jdXMpIHB1Ymxpc2goKTtcbiAgICAgICAgfSwgNTAwKTtcblxuICAgICAgICAvLyB0aGlzLmNvbnRleHRTZXJ2aWNlLnJlbmRlckV2ZW50LmFkZEV2ZW50TGlzdGVuZXIoKCk9PntcbiAgICAgICAgLy8gICAgIGlmICh0aGlzLmZvY3VzU2VydmljZS5oYXNGb2N1cykgcHVibGlzaCgpO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIHB1Ymxpc2gpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHB1Ymxpc2gpO1xuICAgICAgICAgICAgdGhpcy5zZXNzaW9uU2VydmljZS5tYW5hZ2VyLmNsb3NlRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcigoKT0+e1xuICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIHB1Ymxpc2gpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBwdWJsaXNoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuQGF1dG9pbmplY3QoKVxuZXhwb3J0IGNsYXNzIFZpZXdTZXJ2aWNlUHJvdmlkZXIge1xuXG4gICAgcHVibGljIHNlc3Npb25WaWV3cG9ydE1vZGUgPSBuZXcgV2Vha01hcDxTZXNzaW9uUG9ydCwgVmlld3BvcnRNb2RlPigpO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGVtYmVkZGVkIHZpZXdwb3J0cyBmb3IgZWFjaCBtYW5hZ2VkIHNlc3Npb24uXG4gICAgICovXG4gICAgcHVibGljIHNlc3Npb25FbWJlZGRlZFZpZXdwb3J0ID0gbmV3IFdlYWtNYXA8U2Vzc2lvblBvcnQsIFZpZXdwb3J0PigpO1xuXG4gICAgLyoqXG4gICAgICogQSBVSSBldmVudCBiZWluZyBmb3J3YXJkZWQgZnJvbSBhIG1hbmFnZWQgc2Vzc2lvbiBcbiAgICAgKi9cbiAgICBwdWJsaWMgZm9yd2FyZGVkVUlFdmVudCA9IG5ldyBFdmVudDxVSUV2ZW50PigpO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgc2Vzc2lvblNlcnZpY2U6U2Vzc2lvblNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgdmlld1NlcnZpY2U6Vmlld1NlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgZm9jdXNTZXJ2aWNlUHJvdmlkZXI6Rm9jdXNTZXJ2aWNlUHJvdmlkZXIsXG4gICAgICAgIHZpc2liaWxpdHlTZXJ2aWNlUHJvdmlkZXI6VmlzaWJpbGl0eVNlcnZpY2VQcm92aWRlclxuICAgICkge1xuICAgICAgICBzZXNzaW9uU2VydmljZS5lbnN1cmVJc1JlYWxpdHlNYW5hZ2VyKCk7XG5cbiAgICAgICAgc2Vzc2lvblNlcnZpY2UuY29ubmVjdEV2ZW50LmFkZEV2ZW50TGlzdGVuZXIoKHNlc3Npb24pID0+IHtcblxuICAgICAgICAgICAgdGhpcy5zZXNzaW9uVmlld3BvcnRNb2RlLnNldChzZXNzaW9uLCBcbiAgICAgICAgICAgICAgICBzZXNzaW9uID09PSB0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIgPyBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3U2VydmljZS5kZXNpcmVkVmlld3BvcnRNb2RlIDogXG4gICAgICAgICAgICAgICAgICAgIFZpZXdwb3J0TW9kZS5JTU1FUlNJVkVcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGZvcndhcmQgdWkgZXZlbnRzIHRvIHRoZSB2aXNpYmxlIHJlYWxpdHkgdmlld2VyXG4gICAgICAgICAgICBzZXNzaW9uLm9uWydhci52aWV3LmZvcndhcmRVSUV2ZW50J10gPSAodWlldmVudDpVSUV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3J3YXJkZWRVSUV2ZW50LnJhaXNlRXZlbnQodWlldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHNlc3Npb24ub25bJ2FyLnZpZXcuZGVzaXJlZFZpZXdwb3J0TW9kZSddID0gKHttb2RlfTp7bW9kZTpWaWV3cG9ydE1vZGV9KT0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlc3Npb25WaWV3cG9ydE1vZGUuc2V0KHNlc3Npb24sIG1vZGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3B1Ymxpc2hWaWV3cG9ydE1vZGVzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNlc3Npb24ub25bJ2FyLnZpZXcuZW1iZWRkZWRWaWV3cG9ydCddID0gKHZpZXdwb3J0OiBDYW52YXNWaWV3cG9ydCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Vzc2lvbkVtYmVkZGVkVmlld3BvcnQuc2V0KHNlc3Npb24sIHZpZXdwb3J0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcHVibGlzaFZpZXdwb3J0TW9kZXMoKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcblxuICAgICAgICBmb2N1c1NlcnZpY2VQcm92aWRlci5zZXNzaW9uRm9jdXNFdmVudC5hZGRFdmVudExpc3RlbmVyKCgpPT57XG4gICAgICAgICAgICB0aGlzLl9wdWJsaXNoVmlld3BvcnRNb2RlcygpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHB1YmxpYyBzZW5kVUlFdmVudFRvU2Vzc2lvbih1aWV2ZW50OlVJRXZlbnQsIHNlc3Npb246U2Vzc2lvblBvcnQpIHtcbiAgICAgICAgc2Vzc2lvbi5zZW5kKCdhci52aWV3LnVpZXZlbnQnLCB1aWV2ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9wdWJsaXNoVmlld3BvcnRNb2RlcygpIHtcbiAgICAgICAgdGhpcy5zZXNzaW9uU2VydmljZS5tYW5hZ2VyLnNlbmQoJ2FyLnZpZXcudmlld3BvcnRNb2RlJywge1xuICAgICAgICAgICAgbW9kZTogdGhpcy5zZXNzaW9uVmlld3BvcnRNb2RlLmdldCh0aGlzLnNlc3Npb25TZXJ2aWNlLm1hbmFnZXIpXG4gICAgICAgIH0pO1xuICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb24gb2YgdGhpcy5zZXNzaW9uU2VydmljZS5tYW5hZ2VkU2Vzc2lvbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGUgPSAoc2Vzc2lvbiA9PT0gdGhpcy5mb2N1c1NlcnZpY2VQcm92aWRlci5zZXNzaW9uKSA/XG4gICAgICAgICAgICAgICAgdGhpcy5zZXNzaW9uVmlld3BvcnRNb2RlLmdldChzZXNzaW9uKSA6IFZpZXdwb3J0TW9kZS5JTU1FUlNJVkU7XG4gICAgICAgICAgICBpZiAoc2Vzc2lvbi52ZXJzaW9uWzBdID4gMClcbiAgICAgICAgICAgICAgICBzZXNzaW9uLnNlbmQoJ2FyLnZpZXcudmlld3BvcnRNb2RlJywge21vZGV9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG4vLyBzZXR1cCBvdXIgRE9NIGVudmlyb25tZW50XG5pZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KSB7XG4gICAgbGV0IHZpZXdwb3J0TWV0YVRhZyA9IDxIVE1MTWV0YUVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPXZpZXdwb3J0XScpO1xuICAgIGlmICghdmlld3BvcnRNZXRhVGFnKSB2aWV3cG9ydE1ldGFUYWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdtZXRhJyk7XG4gICAgdmlld3BvcnRNZXRhVGFnLm5hbWUgPSAndmlld3BvcnQnXG4gICAgdmlld3BvcnRNZXRhVGFnLmNvbnRlbnQgPSAnd2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWF4aW11bS1zY2FsZT0xLjAsIHVzZXItc2NhbGFibGU9MCdcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHZpZXdwb3J0TWV0YVRhZyk7XG5cbiAgICBsZXQgYXJnb25NZXRhVGFnID0gPEhUTUxNZXRhRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZXRhW25hbWU9YXJnb25dJyk7XG4gICAgaWYgKCFhcmdvbk1ldGFUYWcpIGFyZ29uTWV0YVRhZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ21ldGEnKTtcbiAgICBhcmdvbk1ldGFUYWcubmFtZSA9ICdhcmdvbidcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGFyZ29uTWV0YVRhZyk7XG5cbiAgICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbiAgICBzdHlsZS50eXBlID0gJ3RleHQvY3NzJztcbiAgICBkb2N1bWVudC5oZWFkLmluc2VydEJlZm9yZShzdHlsZSwgZG9jdW1lbnQuaGVhZC5maXJzdENoaWxkKTtcbiAgICBjb25zdCBzaGVldCA9IDxDU1NTdHlsZVNoZWV0PnN0eWxlLnNoZWV0O1xuICAgIHNoZWV0Lmluc2VydFJ1bGUoYFxuICAgICAgICAjYXJnb24ge1xuICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICBsZWZ0OiAwO1xuICAgICAgICAgICAgYm90dG9tOiAwO1xuICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgYm9yZGVyOiAwO1xuICAgICAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgfVxuICAgIGAsIHNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG4gICAgc2hlZXQuaW5zZXJ0UnVsZShgXG4gICAgICAgIC5hcmdvbi12aWV3IHtcbiAgICAgICAgICAgIC13ZWJraXQtdGFwLWhpZ2hsaWdodC1jb2xvcjogdHJhbnNwYXJlbnQ7XG4gICAgICAgICAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lO1xuICAgICAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gICAgICAgIH1cbiAgICBgLCBzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIHNoZWV0Lmluc2VydFJ1bGUoYFxuICAgICAgICAuYXJnb24taW1tZXJzaXZlIC5hcmdvbi12aWV3IHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZCAhaW1wb3J0YW50O1xuICAgICAgICAgICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50O1xuICAgICAgICAgICAgbWF4LXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICBtYXgtaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICBsZWZ0OiAwO1xuICAgICAgICAgICAgYm90dG9tOiAwO1xuICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgYm9yZGVyOiAwO1xuICAgICAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgICAgIHZpc2liaWxpdHk6IHZpc2libGU7XG4gICAgICAgIH1cbiAgICBgLCBzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIHNoZWV0Lmluc2VydFJ1bGUoYFxuICAgICAgICA6bm90KC5hcmdvbi1yZWFsaXR5LW1hbmFnZXIpLmFyZ29uLWltbWVyc2l2ZSBib2R5IHtcbiAgICAgICAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjtcbiAgICAgICAgfVxuICAgIGAsIHNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG4gICAgc2hlZXQuaW5zZXJ0UnVsZShgXG4gICAgICAgIC5hcmdvbi1pbnRlcmFjdGl2ZSB7XG4gICAgICAgICAgICBwb2ludGVyLWV2ZW50czogYXV0bztcbiAgICAgICAgfVxuICAgIGAsIHNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG59XG4iXX0=