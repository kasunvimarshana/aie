var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
import 'aurelia-polyfills';
import * as DI from 'aurelia-dependency-injection';
import * as Cesium from './cesium/cesium-imports';
import './webvr';
import { SessionService, ConnectService, LoopbackConnectService, DOMConnectService, DebugConnectService, WKWebViewConnectService, AndroidWebViewConnectService } from './session';
import { Configuration, Role } from './common';
import { DefaultUIService } from './ui';
import { isIOS, getEventSynthesizier, createEventForwarder, hasNativeWebVRImplementation } from './utils';
import { EntityService, EntityServiceProvider } from './entity';
import { ContextService, ContextServiceProvider } from './context';
import { FocusService, FocusServiceProvider } from './focus';
import { DeviceService, DeviceServiceProvider } from './device';
import { RealityService, RealityServiceProvider, RealityFactory } from './reality';
import { ViewService, ViewServiceProvider, ViewItems } from './view';
import { VisibilityService, VisibilityServiceProvider } from './visibility';
import { VuforiaService, VuforiaServiceProvider } from './vuforia';
import { PermissionService, PermissionServiceProvider } from './permission';
import { RealityViewer } from './reality-viewers/base';
import { EmptyRealityViewer } from './reality-viewers/empty';
import { LiveRealityViewer } from './reality-viewers/live';
import { HostedRealityViewer } from './reality-viewers/hosted';
import { WebRTCRealityViewer } from './reality-viewers/webrtc';
import { TangoRealityViewer } from './reality-viewers/tango';
export { DI, Cesium };
export * from './common';
export * from './context';
export * from './entity';
export * from './focus';
export * from './device';
export * from './reality';
export * from './session';
export * from './ui';
export * from './utils';
export * from './view';
export * from './visibility';
export * from './vuforia';
export * from './permission';
export { RealityViewer, EmptyRealityViewer, LiveRealityViewer, HostedRealityViewer, WebRTCRealityViewer, TangoRealityViewer };
var ArgonSystemProvider = (function () {
    function ArgonSystemProvider(entity, context, focus, device, visibility, reality, view, vuforia, permission) {
        this.entity = entity;
        this.context = context;
        this.focus = focus;
        this.device = device;
        this.visibility = visibility;
        this.reality = reality;
        this.view = view;
        this.vuforia = vuforia;
        this.permission = permission;
    }
    ArgonSystemProvider = __decorate([
        DI.autoinject(),
        __metadata("design:paramtypes", [EntityServiceProvider,
            ContextServiceProvider,
            FocusServiceProvider,
            DeviceServiceProvider,
            VisibilityServiceProvider,
            RealityServiceProvider,
            ViewServiceProvider,
            VuforiaServiceProvider,
            PermissionServiceProvider])
    ], ArgonSystemProvider);
    return ArgonSystemProvider;
}());
export { ArgonSystemProvider };
/**
 * A composition root which instantiates the object graph based on a provided configuration.
 * You generally want to create a new ArgonSystem via the provided [[init]] or [[initReality]] functions:
 * ```ts
 * var app = Argon.init(); // app is an instance of ArgonSystem
 * ```
 */
var ArgonSystem = (function () {
    function ArgonSystem(container, entity, context, device, focus, reality, session, view, visibility, vuforia, permission) {
        this.container = container;
        this.entity = entity;
        this.context = context;
        this.device = device;
        this.focus = focus;
        this.reality = reality;
        this.session = session;
        this.view = view;
        this.visibility = visibility;
        this.vuforia = vuforia;
        this.permission = permission;
        // method shorcuts
        this.getEntityPose = this.context.getEntityPose.bind(this.context);
        this.subscribeGeolocation = this.context.subscribeGeolocation.bind(this.context);
        this.unsubscribeGeolocation = this.context.unsubscribeGeolocation.bind(this.context);
        if (!ArgonSystem_1.instance)
            ArgonSystem_1.instance = this;
        if (this.container.hasResolver(ArgonSystemProvider))
            this._provider = this.container.get(ArgonSystemProvider);
        this._setupDOM();
        this.session.connect();
    }
    ArgonSystem_1 = ArgonSystem;
    ArgonSystem.prototype._setupDOM = function () {
        var _this = this;
        var viewItems = this.container.get(ViewItems);
        var element = viewItems.element;
        if (element && typeof document !== 'undefined' && document.createElement) {
            element.classList.add('argon-view');
            // prevent pinch-zoom of the page in ios 10.
            if (isIOS) {
                var touchMoveListener_1 = function (event) {
                    if (event.touches.length > 1)
                        event.preventDefault();
                };
                element.addEventListener('touchmove', touchMoveListener_1, true);
                this.session.manager.closeEvent.addEventListener(function () {
                    element.removeEventListener('touchmove', touchMoveListener_1);
                });
            }
            // add styles describing the type of the current session
            if (this.session.isRealityViewer) {
                document.documentElement.classList.add('argon-reality-viewer');
            }
            if (this.session.isRealityAugmenter) {
                document.documentElement.classList.add('argon-reality-augmenter');
            }
            if (this.session.isRealityManager) {
                document.documentElement.classList.add('argon-reality-manager');
            }
            // add/remove document-level css classes
            this.focus.focusEvent.on(function () {
                _this.context.renderEvent.onNext(function () {
                    document.documentElement.classList.remove('argon-no-focus');
                    document.documentElement.classList.remove('argon-blur');
                    document.documentElement.classList.add('argon-focus');
                });
            });
            this.focus.blurEvent.on(function () {
                _this.context.renderEvent.onNext(function () {
                    document.documentElement.classList.remove('argon-focus');
                    document.documentElement.classList.add('argon-blur');
                    document.documentElement.classList.add('argon-no-focus');
                });
            });
            this.view.viewportModeChangeEvent.addEventListener(function (mode) {
                _this.context.renderEvent.onNext(function () {
                    switch (mode) {
                        case 0 /* EMBEDDED */:
                            var elementStyle = _this.view.element.style;
                            elementStyle.position = '';
                            elementStyle.left = '0px';
                            elementStyle.bottom = '0px';
                            elementStyle.width = '100%';
                            elementStyle.height = '100%';
                            document.documentElement.classList.remove('argon-immersive');
                            break;
                        case 1 /* IMMERSIVE */:
                            document.documentElement.classList.add('argon-immersive');
                            break;
                    }
                });
            });
            // Setup event forwarding / synthesizing
            if (this.session.isRealityViewer) {
                this.session.manager.on['ar.view.uievent'] = getEventSynthesizier();
            }
            else {
                createEventForwarder(this.view, function (event) {
                    if (_this.session.manager.isConnected && _this.session.manager.version[0] >= 1)
                        _this.session.manager.send('ar.view.forwardUIEvent', event);
                });
                this.view._watchEmbeddedViewport();
            }
            if (!this.session.isRealityManager) {
                this.view.viewportChangeEvent.addEventListener(function (viewport) {
                    _this.context.renderEvent.onNext(function () {
                        if (_this.view.element && _this.view.autoLayoutImmersiveMode &&
                            _this.view.viewportMode === 1 /* IMMERSIVE */) {
                            var elementStyle = _this.view.element.style;
                            elementStyle.position = 'fixed';
                            elementStyle.left = viewport.x + 'px';
                            elementStyle.bottom = viewport.y + 'px';
                            elementStyle.width = viewport.width + 'px';
                            elementStyle.height = viewport.height + 'px';
                        }
                    });
                });
            }
            this.context.renderEvent.addEventListener(function () {
                if (_this.view.autoStyleLayerElements) {
                    var layers = _this.view.layers;
                    if (!layers)
                        return;
                    var viewport = _this.view.viewport;
                    var zIndex = 1;
                    for (var _i = 0, layers_1 = layers; _i < layers_1.length; _i++) {
                        var layer = layers_1[_i];
                        var layerStyle = layer.source.style;
                        layerStyle.position = 'absolute';
                        layerStyle.left = viewport.x + 'px';
                        layerStyle.bottom = viewport.y + 'px';
                        layerStyle.width = viewport.width + 'px';
                        layerStyle.height = viewport.height + 'px';
                        layerStyle.zIndex = '' + zIndex;
                        zIndex++;
                    }
                }
            });
        }
    };
    Object.defineProperty(ArgonSystem.prototype, "suggestedPixelRatio", {
        get: function () {
            if (this.device.isPresentingHMD && hasNativeWebVRImplementation)
                return 1;
            var devicePixelRatio = typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1;
            if (this.focus.hasFocus) {
                return devicePixelRatio;
            }
            else {
                return devicePixelRatio * 0.5;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "provider", {
        get: function () {
            this.session.ensureIsRealityManager();
            return this._provider;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "updateEvent", {
        // event shortcuts
        get: function () {
            return this.context.updateEvent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "renderEvent", {
        get: function () {
            return this.context.renderEvent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "focusEvent", {
        get: function () {
            return this.focus.focusEvent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "blurEvent", {
        get: function () {
            return this.focus.blurEvent;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "stage", {
        // entity shortcuts
        get: function () {
            return this.context.stage;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "stageEUS", {
        get: function () {
            return this.context.stageEUS;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "stageENU", {
        get: function () {
            return this.context.stageENU;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "user", {
        get: function () {
            return this.context.user;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "displayMode", {
        // other shorcuts
        /**
         * The mode of the current display. This can be either
         * 'hand' for handheld display mode, 'head' for a head-mounted mode,
         * or 'other'.
         */
        get: function () {
            return this.device.displayMode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "userTracking", {
        /**
         * The DOF supported by the current reality.
         */
        get: function () {
            return this.context.userTracking;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "geoHeadingAccuracy", {
        /**
         * If geopose is available, this is the accuracy of the user heading
         */
        get: function () {
            return this.context.geoHeadingAccuracy;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "geoVerticalAccuracy", {
        /**
         * If geopose is available, this is the vertical accuracy of the user geolocation
         */
        get: function () {
            return this.context.geoVerticalAccuracy;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ArgonSystem.prototype, "geoHorizontalAccuracy", {
        /**
         * If geopose is available, this is the vertical accuracy of the user geolocation
         */
        get: function () {
            return this.context.geoHorizontalAccuracy;
        },
        enumerable: true,
        configurable: true
    });
    ArgonSystem.prototype.destroy = function () {
        this.session.manager.close();
        if (ArgonSystem_1.instance === this) {
            ArgonSystem_1.instance = undefined;
        }
    };
    ArgonSystem = ArgonSystem_1 = __decorate([
        DI.autoinject,
        __metadata("design:paramtypes", [DI.Container, EntityService,
            ContextService,
            DeviceService,
            FocusService,
            RealityService,
            SessionService,
            ViewService,
            VisibilityService,
            VuforiaService,
            PermissionService])
    ], ArgonSystem);
    return ArgonSystem;
    var ArgonSystem_1;
}());
export { ArgonSystem };
var ArgonContainerManager = (function () {
    function ArgonContainerManager(configuration, container, elementOrSelector) {
        if (container === void 0) { container = new DI.Container; }
        this.configuration = configuration;
        this.container = container;
        this.elementOrSelector = elementOrSelector;
        container.registerInstance(Configuration, configuration);
        if (Role.isRealityManager(configuration.role)) {
            container.registerSingleton(ArgonSystemProvider);
        }
        var element = elementOrSelector;
        if (!element || typeof element === 'string') {
            if (typeof document !== 'undefined') {
                var selector = element;
                element = selector ? document.querySelector(selector) : undefined;
                if (!element && !selector) {
                    element = document.querySelector('#argon');
                    if (!element) {
                        element = document.createElement('div');
                        element.id = 'argon';
                        document.body.appendChild(element);
                    }
                }
                else if (!element) {
                    throw new Error('Unable to find element with selector: ' + selector);
                }
            }
            else {
                element = undefined;
            }
        }
        var viewItems = new ViewItems();
        viewItems.element = element;
        container.registerInstance(ViewItems, viewItems);
        ArgonContainerManager.configure(this);
    }
    ArgonContainerManager.configure = function (configurationManager) {
        configurationManager.standardConfiguration();
    };
    Object.defineProperty(ArgonContainerManager.prototype, "app", {
        get: function () {
            return this.container.get(ArgonSystem);
        },
        enumerable: true,
        configurable: true
    });
    ArgonContainerManager.prototype.standardConfiguration = function () {
        this.defaultConnect();
        this.defaultRealityFactory();
        this.defaultUI();
    };
    ArgonContainerManager.prototype.defaultConnect = function () {
        var container = this.container;
        var configuration = this.configuration;
        if (Role.isRealityManager(configuration.role)) {
            container.registerSingleton(ConnectService, LoopbackConnectService);
        }
        else if (WKWebViewConnectService.isAvailable()) {
            container.registerSingleton(ConnectService, WKWebViewConnectService);
        }
        else if (AndroidWebViewConnectService.isAvailable()) {
            container.registerSingleton(ConnectService, AndroidWebViewConnectService);
        }
        else if (DOMConnectService.isAvailable()) {
            container.registerSingleton(ConnectService, DOMConnectService);
        }
        else if (DebugConnectService.isAvailable()) {
            container.registerSingleton(ConnectService, DebugConnectService);
        }
    };
    ArgonContainerManager.prototype.defaultRealityFactory = function () {
        this.container.registerSingleton(RealityFactory, DefaultRealityFactory);
    };
    ArgonContainerManager.prototype.defaultUI = function () {
        if (Role.isRealityManager(this.configuration.role)) {
            if (typeof document !== 'undefined') {
                this.container.get(DefaultUIService);
            }
        }
    };
    return ArgonContainerManager;
}());
export { ArgonContainerManager };
var DefaultRealityFactory = (function () {
    function DefaultRealityFactory(container) {
        this.container = container;
    }
    ;
    DefaultRealityFactory.prototype.createRealityViewer = function (uri) {
        console.log('creating ' + uri);
        switch (RealityViewer.getType(uri)) {
            case RealityViewer.EMPTY:
                return this.container.invoke(EmptyRealityViewer, [uri]);
            case RealityViewer.LIVE:
                return this.container.invoke(LiveRealityViewer, [uri]);
            case RealityViewer.WEBRTC:
                return this.container.invoke(WebRTCRealityViewer, [uri]);
            case 'hosted':
                return this.container.invoke(HostedRealityViewer, [uri]);
            case RealityViewer.TANGO:
                return this.container.invoke(TangoRealityViewer, [uri]);
            default:
                throw new Error('Unsupported Reality Viewer: ' + uri);
        }
    };
    DefaultRealityFactory = __decorate([
        DI.autoinject,
        __metadata("design:paramtypes", [DI.Container])
    ], DefaultRealityFactory);
    return DefaultRealityFactory;
}());
export function init(elementOrConfig, configurationOrDIContainer, dependencyInjectionContainer) {
    if (ArgonSystem.instance)
        throw new Error('A shared ArgonSystem instance already exists');
    var element;
    var configuration;
    if (configurationOrDIContainer instanceof DI.Container) {
        configuration = elementOrConfig;
        dependencyInjectionContainer = configurationOrDIContainer;
    }
    else {
        element = elementOrConfig;
        configuration = configurationOrDIContainer;
    }
    // see if it is the old parameter interface
    if (element && (element['configuration'] || element['container'])) {
        var deprecatedParameters = element;
        if (!configuration && deprecatedParameters['configuration'])
            configuration = deprecatedParameters['configuration'];
        if (!configuration && deprecatedParameters['container'])
            dependencyInjectionContainer = deprecatedParameters['container'];
        element = undefined;
    }
    if (!configuration)
        configuration = {};
    if (!configuration.role) {
        var role = void 0;
        if (typeof HTMLElement === 'undefined') {
            role = Role.REALITY_MANAGER;
        }
        else if (navigator.userAgent.indexOf('Argon') > 0 || window.top !== window) {
            role = Role.APPLICATION; // TODO: switch to below after several argon-app releases
            // role = Role.REALITY_AUGMENTER
        }
        else {
            role = Role.REALITY_MANAGER;
        }
        configuration.role = role;
    }
    if (!dependencyInjectionContainer)
        dependencyInjectionContainer = new DI.Container();
    return new ArgonContainerManager(configuration, dependencyInjectionContainer, element).app;
}
/**
 * Initialize an [[ArgonSystem]] with the [[REALITY_VIEWER]] role
 */
export function initRealityViewer(configuration, dependencyInjectionContainer) {
    if (configuration === void 0) { configuration = {}; }
    if (dependencyInjectionContainer === void 0) { dependencyInjectionContainer = new DI.Container; }
    if (ArgonSystem.instance)
        throw new Error('A shared ArgonSystem instance already exists');
    configuration.role = Role.REALITY_VIEW; // TODO: switch to below after several argon-app releases
    // configuration.role = Role.REALITY_VIEWER;
    configuration['supportsCustomProtocols'] = true;
    configuration['reality.supportsControlPort'] = true; // backwards compat for above
    configuration.protocols = configuration.protocols || [];
    configuration.protocols.push('ar.uievent');
    return new ArgonContainerManager(configuration, dependencyInjectionContainer).app;
}
/**
 * @private
 */
export var initReality = initRealityViewer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJnb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhcmdvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxPQUFPLG1CQUFtQixDQUFBO0FBQzFCLE9BQU8sS0FBSyxFQUFFLE1BQU0sOEJBQThCLENBQUE7QUFDbEQsT0FBTyxLQUFLLE1BQU0sTUFBTSx5QkFBeUIsQ0FBQTtBQUNqRCxPQUFPLFNBQVMsQ0FBQTtBQUVoQixPQUFPLEVBQ0gsY0FBYyxFQUNkLGNBQWMsRUFDZCxzQkFBc0IsRUFDdEIsaUJBQWlCLEVBQ2pCLG1CQUFtQixFQUNuQix1QkFBdUIsRUFDdkIsNEJBQTRCLEVBQy9CLE1BQU0sV0FBVyxDQUFBO0FBRWxCLE9BQU8sRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBQzlDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLE1BQU0sQ0FBQTtBQUN2QyxPQUFPLEVBQVMsS0FBSyxFQUFFLG9CQUFvQixFQUFFLG9CQUFvQixFQUFFLDRCQUE0QixFQUFFLE1BQU0sU0FBUyxDQUFBO0FBRWhILE9BQU8sRUFBRSxhQUFhLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDL0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxzQkFBc0IsRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUNsRSxPQUFPLEVBQUUsWUFBWSxFQUFFLG9CQUFvQixFQUFFLE1BQU0sU0FBUyxDQUFBO0FBQzVELE9BQU8sRUFBRSxhQUFhLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDL0QsT0FBTyxFQUFFLGNBQWMsRUFBRSxzQkFBc0IsRUFBRSxjQUFjLEVBQUUsTUFBTSxXQUFXLENBQUE7QUFDbEYsT0FBTyxFQUFFLFdBQVcsRUFBRSxtQkFBbUIsRUFBRSxTQUFTLEVBQWdCLE1BQU0sUUFBUSxDQUFBO0FBQ2xGLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGNBQWMsQ0FB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QUFhLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyx5REFBeUQ7SUFDakcsNENBQTRDO0lBQzVDLGFBQWEsQ0FBQyx5QkFBeUIsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUNoRCxhQUFhLENBQUMsNkJBQTZCLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyw2QkFBNkI7SUFDbEYsYUFBYSxDQUFDLFNBQVMsR0FBRyxhQUFhLENBQUMsU0FBUyxJQUFJLEVBQUUsQ0FBQztJQUN4RCxhQUFhLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQTtJQUMxQyxNQUFNLENBQUMsSUFBSSxxQkFBcUIsQ0FBQyxhQUFhLEVBQUUsNEJBQTRCLENBQUMsQ0FBQyxHQUFHLENBQUM7QUFDdEYsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxDQUFDLElBQU0sV0FBVyxHQUFHLGlCQUFpQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICdhdXJlbGlhLXBvbHlmaWxscydcbmltcG9ydCAqIGFzIERJIGZyb20gJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nXG5pbXBvcnQgKiBhcyBDZXNpdW0gZnJvbSAnLi9jZXNpdW0vY2VzaXVtLWltcG9ydHMnXG5pbXBvcnQgJy4vd2VidnInXG5cbmltcG9ydCB7XG4gICAgU2Vzc2lvblNlcnZpY2UsXG4gICAgQ29ubmVjdFNlcnZpY2UsXG4gICAgTG9vcGJhY2tDb25uZWN0U2VydmljZSxcbiAgICBET01Db25uZWN0U2VydmljZSxcbiAgICBEZWJ1Z0Nvbm5lY3RTZXJ2aWNlLFxuICAgIFdLV2ViVmlld0Nvbm5lY3RTZXJ2aWNlLFxuICAgIEFuZHJvaWRXZWJWaWV3Q29ubmVjdFNlcnZpY2Vcbn0gZnJvbSAnLi9zZXNzaW9uJ1xuXG5pbXBvcnQgeyBDb25maWd1cmF0aW9uLCBSb2xlIH0gZnJvbSAnLi9jb21tb24nXG5pbXBvcnQgeyBEZWZhdWx0VUlTZXJ2aWNlIH0gZnJvbSAnLi91aSdcbmltcG9ydCB7IEV2ZW50LCBpc0lPUywgZ2V0RXZlbnRTeW50aGVzaXppZXIsIGNyZWF0ZUV2ZW50Rm9yd2FyZGVyLCBoYXNOYXRpdmVXZWJWUkltcGxlbWVudGF0aW9uIH0gZnJvbSAnLi91dGlscydcblxuaW1wb3J0IHsgRW50aXR5U2VydmljZSwgRW50aXR5U2VydmljZVByb3ZpZGVyIH0gZnJvbSAnLi9lbnRpdHknXG5pbXBvcnQgeyBDb250ZXh0U2VydmljZSwgQ29udGV4dFNlcnZpY2VQcm92aWRlciB9IGZyb20gJy4vY29udGV4dCdcbmltcG9ydCB7IEZvY3VzU2VydmljZSwgRm9jdXNTZXJ2aWNlUHJvdmlkZXIgfSBmcm9tICcuL2ZvY3VzJ1xuaW1wb3J0IHsgRGV2aWNlU2VydmljZSwgRGV2aWNlU2VydmljZVByb3ZpZGVyIH0gZnJvbSAnLi9kZXZpY2UnXG5pbXBvcnQgeyBSZWFsaXR5U2VydmljZSwgUmVhbGl0eVNlcnZpY2VQcm92aWRlciwgUmVhbGl0eUZhY3RvcnkgfSBmcm9tICcuL3JlYWxpdHknXG5pbXBvcnQgeyBWaWV3U2VydmljZSwgVmlld1NlcnZpY2VQcm92aWRlciwgVmlld0l0ZW1zLCBWaWV3cG9ydE1vZGUgfSBmcm9tICcuL3ZpZXcnXG5pbXBvcnQgeyBWaXNpYmlsaXR5U2VydmljZSwgVmlzaWJpbGl0eVNlcnZpY2VQcm92aWRlciB9IGZyb20gJy4vdmlzaWJpbGl0eSdcbmltcG9ydCB7IFZ1Zm9yaWFTZXJ2aWNlLCBWdWZvcmlhU2VydmljZVByb3ZpZGVyIH0gZnJvbSAnLi92dWZvcmlhJ1xuaW1wb3J0IHsgUGVybWlzc2lvblNlcnZpY2UsIFBlcm1pc3Npb25TZXJ2aWNlUHJvdmlkZXIgfSBmcm9tICcuL3Blcm1pc3Npb24nXG5cbmltcG9ydCB7IFJlYWxpdHlWaWV3ZXIgfSBmcm9tICcuL3JlYWxpdHktdmlld2Vycy9iYXNlJ1xuaW1wb3J0IHsgRW1wdHlSZWFsaXR5Vmlld2VyIH0gZnJvbSAnLi9yZWFsaXR5LXZpZXdlcnMvZW1wdHknXG5pbXBvcnQgeyBMaXZlUmVhbGl0eVZpZXdlciB9IGZyb20gJy4vcmVhbGl0eS12aWV3ZXJzL2xpdmUnXG5pbXBvcnQgeyBIb3N0ZWRSZWFsaXR5Vmlld2VyIH0gZnJvbSAnLi9yZWFsaXR5LXZpZXdlcnMvaG9zdGVkJ1xuaW1wb3J0IHsgV2ViUlRDUmVhbGl0eVZpZXdlciB9IGZyb20gJy4vcmVhbGl0eS12aWV3ZXJzL3dlYnJ0YydcbmltcG9ydCB7IFRhbmdvUmVhbGl0eVZpZXdlciB9IGZyb20gJy4vcmVhbGl0eS12aWV3ZXJzL3RhbmdvJ1xuXG5leHBvcnQgeyBESSwgQ2VzaXVtIH1cbmV4cG9ydCAqIGZyb20gJy4vY29tbW9uJ1xuZXhwb3J0ICogZnJvbSAnLi9jb250ZXh0J1xuZXhwb3J0ICogZnJvbSAnLi9lbnRpdHknXG5leHBvcnQgKiBmcm9tICcuL2ZvY3VzJ1xuZXhwb3J0ICogZnJvbSAnLi9kZXZpY2UnXG5leHBvcnQgKiBmcm9tICcuL3JlYWxpdHknXG5leHBvcnQgKiBmcm9tICcuL3Nlc3Npb24nXG5leHBvcnQgKiBmcm9tICcuL3VpJ1xuZXhwb3J0ICogZnJvbSAnLi91dGlscydcbmV4cG9ydCAqIGZyb20gJy4vdmlldydcbmV4cG9ydCAqIGZyb20gJy4vdmlzaWJpbGl0eSdcbmV4cG9ydCAqIGZyb20gJy4vdnVmb3JpYSdcbmV4cG9ydCAqIGZyb20gJy4vcGVybWlzc2lvbidcblxuZXhwb3J0IHtcbiAgICBSZWFsaXR5Vmlld2VyLFxuICAgIEVtcHR5UmVhbGl0eVZpZXdlcixcbiAgICBMaXZlUmVhbGl0eVZpZXdlcixcbiAgICBIb3N0ZWRSZWFsaXR5Vmlld2VyLFxuICAgIFdlYlJUQ1JlYWxpdHlWaWV3ZXIsXG4gICAgVGFuZ29SZWFsaXR5Vmlld2VyXG59XG5cbkBESS5hdXRvaW5qZWN0KClcbmV4cG9ydCBjbGFzcyBBcmdvblN5c3RlbVByb3ZpZGVyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGVudGl0eTpFbnRpdHlTZXJ2aWNlUHJvdmlkZXIsXG4gICAgICAgIHB1YmxpYyBjb250ZXh0OkNvbnRleHRTZXJ2aWNlUHJvdmlkZXIsXG4gICAgICAgIHB1YmxpYyBmb2N1czpGb2N1c1NlcnZpY2VQcm92aWRlcixcbiAgICAgICAgcHVibGljIGRldmljZTpEZXZpY2VTZXJ2aWNlUHJvdmlkZXIsXG4gICAgICAgIHB1YmxpYyB2aXNpYmlsaXR5OlZpc2liaWxpdHlTZXJ2aWNlUHJvdmlkZXIsXG4gICAgICAgIHB1YmxpYyByZWFsaXR5OlJlYWxpdHlTZXJ2aWNlUHJvdmlkZXIsIFxuICAgICAgICBwdWJsaWMgdmlldzpWaWV3U2VydmljZVByb3ZpZGVyLFxuICAgICAgICBwdWJsaWMgdnVmb3JpYTpWdWZvcmlhU2VydmljZVByb3ZpZGVyLFxuICAgICAgICBwdWJsaWMgcGVybWlzc2lvbjpQZXJtaXNzaW9uU2VydmljZVByb3ZpZGVyXG4gICAgKSB7fVxufVxuXG4vKipcbiAqIEEgY29tcG9zaXRpb24gcm9vdCB3aGljaCBpbnN0YW50aWF0ZXMgdGhlIG9iamVjdCBncmFwaCBiYXNlZCBvbiBhIHByb3ZpZGVkIGNvbmZpZ3VyYXRpb24uXG4gKiBZb3UgZ2VuZXJhbGx5IHdhbnQgdG8gY3JlYXRlIGEgbmV3IEFyZ29uU3lzdGVtIHZpYSB0aGUgcHJvdmlkZWQgW1tpbml0XV0gb3IgW1tpbml0UmVhbGl0eV1dIGZ1bmN0aW9uczpcbiAqIGBgYHRzXG4gKiB2YXIgYXBwID0gQXJnb24uaW5pdCgpOyAvLyBhcHAgaXMgYW4gaW5zdGFuY2Ugb2YgQXJnb25TeXN0ZW1cbiAqIGBgYFxuICovXG5AREkuYXV0b2luamVjdFxuZXhwb3J0IGNsYXNzIEFyZ29uU3lzdGVtIHtcblxuICAgIC8qKlxuICAgICAqIFRoZSBBcmdvblN5c3RlbSBpbnN0YW5jZSB3aGljaCBzaGFyZXMgYSB2aWV3IHByb3ZpZGVkIGJ5IGEgbWFuYWdlclxuICAgICAqL1xuICAgIHN0YXRpYyBpbnN0YW5jZT86IEFyZ29uU3lzdGVtO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBjb250YWluZXI6IERJLkNvbnRhaW5lcixcbiAgICAgICAgcHVibGljIGVudGl0eTpFbnRpdHlTZXJ2aWNlLFxuICAgICAgICBwdWJsaWMgY29udGV4dDogQ29udGV4dFNlcnZpY2UsXG4gICAgICAgIHB1YmxpYyBkZXZpY2U6IERldmljZVNlcnZpY2UsXG4gICAgICAgIHB1YmxpYyBmb2N1czogRm9jdXNTZXJ2aWNlLFxuICAgICAgICBwdWJsaWMgcmVhbGl0eTogUmVhbGl0eVNlcnZpY2UsXG4gICAgICAgIHB1YmxpYyBzZXNzaW9uOiBTZXNzaW9uU2VydmljZSxcbiAgICAgICAgcHVibGljIHZpZXc6IFZpZXdTZXJ2aWNlLFxuICAgICAgICBwdWJsaWMgdmlzaWJpbGl0eTogVmlzaWJpbGl0eVNlcnZpY2UsXG4gICAgICAgIHB1YmxpYyB2dWZvcmlhOiBWdWZvcmlhU2VydmljZSxcbiAgICAgICAgcHVibGljIHBlcm1pc3Npb246IFBlcm1pc3Npb25TZXJ2aWNlXG4gICAgKSB7XG4gICAgICAgIGlmICghQXJnb25TeXN0ZW0uaW5zdGFuY2UpIEFyZ29uU3lzdGVtLmluc3RhbmNlID0gdGhpcztcblxuICAgICAgICBpZiAodGhpcy5jb250YWluZXIuaGFzUmVzb2x2ZXIoQXJnb25TeXN0ZW1Qcm92aWRlcikpIFxuICAgICAgICAgICAgdGhpcy5fcHJvdmlkZXIgPSB0aGlzLmNvbnRhaW5lci5nZXQoQXJnb25TeXN0ZW1Qcm92aWRlcik7XG5cbiAgICAgICAgdGhpcy5fc2V0dXBET00oKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuc2Vzc2lvbi5jb25uZWN0KCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfc2V0dXBET00oKSB7XG4gICAgICAgIGNvbnN0IHZpZXdJdGVtczpWaWV3SXRlbXMgPSB0aGlzLmNvbnRhaW5lci5nZXQoVmlld0l0ZW1zKTtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHZpZXdJdGVtcy5lbGVtZW50O1xuXG4gICAgICAgIGlmIChlbGVtZW50ICYmIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FyZ29uLXZpZXcnKTtcblxuICAgICAgICAgICAgLy8gcHJldmVudCBwaW5jaC16b29tIG9mIHRoZSBwYWdlIGluIGlvcyAxMC5cbiAgICAgICAgICAgIGlmIChpc0lPUykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvdWNoTW92ZUxpc3RlbmVyID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50b3VjaGVzLmxlbmd0aCA+IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRvdWNoTW92ZUxpc3RlbmVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlc3Npb24ubWFuYWdlci5jbG9zZUV2ZW50LmFkZEV2ZW50TGlzdGVuZXIoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCB0b3VjaE1vdmVMaXN0ZW5lcilcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIHN0eWxlcyBkZXNjcmliaW5nIHRoZSB0eXBlIG9mIHRoZSBjdXJyZW50IHNlc3Npb25cbiAgICAgICAgICAgIGlmICh0aGlzLnNlc3Npb24uaXNSZWFsaXR5Vmlld2VyKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FyZ29uLXJlYWxpdHktdmlld2VyJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5zZXNzaW9uLmlzUmVhbGl0eUF1Z21lbnRlcikge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhcmdvbi1yZWFsaXR5LWF1Z21lbnRlcicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc2Vzc2lvbi5pc1JlYWxpdHlNYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FyZ29uLXJlYWxpdHktbWFuYWdlcicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQvcmVtb3ZlIGRvY3VtZW50LWxldmVsIGNzcyBjbGFzc2VzXG4gICAgICAgICAgICB0aGlzLmZvY3VzLmZvY3VzRXZlbnQub24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW5kZXJFdmVudC5vbk5leHQoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FyZ29uLW5vLWZvY3VzJyk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdhcmdvbi1ibHVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhcmdvbi1mb2N1cycpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5mb2N1cy5ibHVyRXZlbnQub24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW5kZXJFdmVudC5vbk5leHQoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2FyZ29uLWZvY3VzJyk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhcmdvbi1ibHVyJyk7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhcmdvbi1uby1mb2N1cycpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMudmlldy52aWV3cG9ydE1vZGVDaGFuZ2VFdmVudC5hZGRFdmVudExpc3RlbmVyKChtb2RlKT0+e1xuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5yZW5kZXJFdmVudC5vbk5leHQoKCk9PntcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFZpZXdwb3J0TW9kZS5FTUJFRERFRDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50U3R5bGUgPSB0aGlzLnZpZXcuZWxlbWVudC5zdHlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50U3R5bGUucG9zaXRpb24gPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50U3R5bGUubGVmdCA9ICcwcHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRTdHlsZS5ib3R0b20gPSAnMHB4JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50U3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFN0eWxlLmhlaWdodCA9ICcxMDAlJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYXJnb24taW1tZXJzaXZlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFZpZXdwb3J0TW9kZS5JTU1FUlNJVkU6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FyZ29uLWltbWVyc2l2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gU2V0dXAgZXZlbnQgZm9yd2FyZGluZyAvIHN5bnRoZXNpemluZ1xuICAgICAgICAgICAgaWYgKHRoaXMuc2Vzc2lvbi5pc1JlYWxpdHlWaWV3ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlc3Npb24ubWFuYWdlci5vblsnYXIudmlldy51aWV2ZW50J10gPSBnZXRFdmVudFN5bnRoZXNpemllcigpITtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlRXZlbnRGb3J3YXJkZXIodGhpcy52aWV3LCAoZXZlbnQpPT57XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlc3Npb24ubWFuYWdlci5pc0Nvbm5lY3RlZCAmJiB0aGlzLnNlc3Npb24ubWFuYWdlci52ZXJzaW9uWzBdID49IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlc3Npb24ubWFuYWdlci5zZW5kKCdhci52aWV3LmZvcndhcmRVSUV2ZW50JywgZXZlbnQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMudmlldy5fd2F0Y2hFbWJlZGRlZFZpZXdwb3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghdGhpcy5zZXNzaW9uLmlzUmVhbGl0eU1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcudmlld3BvcnRDaGFuZ2VFdmVudC5hZGRFdmVudExpc3RlbmVyKCh2aWV3cG9ydCk9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0LnJlbmRlckV2ZW50Lm9uTmV4dCgoKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmlldy5lbGVtZW50ICYmIHRoaXMudmlldy5hdXRvTGF5b3V0SW1tZXJzaXZlTW9kZSAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcudmlld3BvcnRNb2RlID09PSBWaWV3cG9ydE1vZGUuSU1NRVJTSVZFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudFN0eWxlID0gdGhpcy52aWV3LmVsZW1lbnQuc3R5bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50U3R5bGUubGVmdCA9IHZpZXdwb3J0LnggKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRTdHlsZS5ib3R0b20gPSB2aWV3cG9ydC55ICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50U3R5bGUud2lkdGggPSB2aWV3cG9ydC53aWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudFN0eWxlLmhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQucmVuZGVyRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcigoKT0+e1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZpZXcuYXV0b1N0eWxlTGF5ZXJFbGVtZW50cykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXllcnMgPSB0aGlzLnZpZXcubGF5ZXJzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWxheWVycykgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXdwb3J0ID0gdGhpcy52aWV3LnZpZXdwb3J0O1xuICAgICAgICAgICAgICAgICAgICBsZXQgekluZGV4ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsYXllciBvZiBsYXllcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxheWVyU3R5bGUgPSBsYXllci5zb3VyY2Uuc3R5bGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllclN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyU3R5bGUubGVmdCA9IHZpZXdwb3J0LnggKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF5ZXJTdHlsZS5ib3R0b20gPSB2aWV3cG9ydC55ICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyU3R5bGUud2lkdGggPSB2aWV3cG9ydC53aWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllclN0eWxlLmhlaWdodCA9IHZpZXdwb3J0LmhlaWdodCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXllclN0eWxlLnpJbmRleCA9ICcnICsgekluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgekluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgc3VnZ2VzdGVkUGl4ZWxSYXRpbygpIHtcbiAgICAgICAgaWYgKHRoaXMuZGV2aWNlLmlzUHJlc2VudGluZ0hNRCAmJiBoYXNOYXRpdmVXZWJWUkltcGxlbWVudGF0aW9uKSByZXR1cm4gMTtcblxuICAgICAgICBjb25zdCBkZXZpY2VQaXhlbFJhdGlvID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxIDogMVxuICAgICAgICBpZiAodGhpcy5mb2N1cy5oYXNGb2N1cykge1xuICAgICAgICAgICAgcmV0dXJuIGRldmljZVBpeGVsUmF0aW87XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAqIDAuNTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBfcHJvdmlkZXI6QXJnb25TeXN0ZW1Qcm92aWRlcjtcbiAgICBwdWJsaWMgZ2V0IHByb3ZpZGVyKCkge1xuICAgICAgICB0aGlzLnNlc3Npb24uZW5zdXJlSXNSZWFsaXR5TWFuYWdlcigpO1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJvdmlkZXI7XG4gICAgfVxuXG4gICAgLy8gZXZlbnQgc2hvcnRjdXRzXG5cbiAgICBwdWJsaWMgZ2V0IHVwZGF0ZUV2ZW50KCk6IEV2ZW50PGFueT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnVwZGF0ZUV2ZW50O1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgcmVuZGVyRXZlbnQoKTogRXZlbnQ8YW55PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQucmVuZGVyRXZlbnQ7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBmb2N1c0V2ZW50KCk6IEV2ZW50PHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9jdXMuZm9jdXNFdmVudDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGJsdXJFdmVudCgpOiBFdmVudDx2b2lkPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvY3VzLmJsdXJFdmVudDtcbiAgICB9XG5cbiAgICAvLyBlbnRpdHkgc2hvcnRjdXRzXG5cbiAgICBwdWJsaWMgZ2V0IHN0YWdlKCkgOiBDZXNpdW0uRW50aXR5IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5zdGFnZTtcbiAgICB9XG4gICAgXG4gICAgcHVibGljIGdldCBzdGFnZUVVUygpIDogQ2VzaXVtLkVudGl0eSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuc3RhZ2VFVVM7XG4gICAgfVxuICAgIFxuICAgIHB1YmxpYyBnZXQgc3RhZ2VFTlUoKSA6IENlc2l1bS5FbnRpdHkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnN0YWdlRU5VO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgdXNlcigpIDogQ2VzaXVtLkVudGl0eSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQudXNlcjtcbiAgICB9XG5cbiAgICAvLyBtZXRob2Qgc2hvcmN1dHNcblxuICAgIHB1YmxpYyBnZXRFbnRpdHlQb3NlIDogdHlwZW9mIENvbnRleHRTZXJ2aWNlLnByb3RvdHlwZS5nZXRFbnRpdHlQb3NlID0gXG4gICAgICAgIHRoaXMuY29udGV4dC5nZXRFbnRpdHlQb3NlLmJpbmQodGhpcy5jb250ZXh0KTtcblxuICAgIHB1YmxpYyBzdWJzY3JpYmVHZW9sb2NhdGlvbiA6IHR5cGVvZiBDb250ZXh0U2VydmljZS5wcm90b3R5cGUuc3Vic2NyaWJlR2VvbG9jYXRpb24gPSBcbiAgICAgICAgdGhpcy5jb250ZXh0LnN1YnNjcmliZUdlb2xvY2F0aW9uLmJpbmQodGhpcy5jb250ZXh0KTtcbiAgICBcbiAgICBwdWJsaWMgdW5zdWJzY3JpYmVHZW9sb2NhdGlvbiA6IHR5cGVvZiBDb250ZXh0U2VydmljZS5wcm90b3R5cGUudW5zdWJzY3JpYmVHZW9sb2NhdGlvbiA9IFxuICAgICAgICB0aGlzLmNvbnRleHQudW5zdWJzY3JpYmVHZW9sb2NhdGlvbi5iaW5kKHRoaXMuY29udGV4dCk7XG5cbiAgICAvLyBvdGhlciBzaG9yY3V0c1xuXG4gICAgLyoqXG4gICAgICogVGhlIG1vZGUgb2YgdGhlIGN1cnJlbnQgZGlzcGxheS4gVGhpcyBjYW4gYmUgZWl0aGVyXG4gICAgICogJ2hhbmQnIGZvciBoYW5kaGVsZCBkaXNwbGF5IG1vZGUsICdoZWFkJyBmb3IgYSBoZWFkLW1vdW50ZWQgbW9kZSxcbiAgICAgKiBvciAnb3RoZXInLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZGlzcGxheU1vZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRldmljZS5kaXNwbGF5TW9kZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgRE9GIHN1cHBvcnRlZCBieSB0aGUgY3VycmVudCByZWFsaXR5LlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgdXNlclRyYWNraW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnVzZXJUcmFja2luZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiBnZW9wb3NlIGlzIGF2YWlsYWJsZSwgdGhpcyBpcyB0aGUgYWNjdXJhY3kgb2YgdGhlIHVzZXIgaGVhZGluZ1xuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZ2VvSGVhZGluZ0FjY3VyYWN5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0Lmdlb0hlYWRpbmdBY2N1cmFjeTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiBnZW9wb3NlIGlzIGF2YWlsYWJsZSwgdGhpcyBpcyB0aGUgdmVydGljYWwgYWNjdXJhY3kgb2YgdGhlIHVzZXIgZ2VvbG9jYXRpb25cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGdlb1ZlcnRpY2FsQWNjdXJhY3koKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQuZ2VvVmVydGljYWxBY2N1cmFjeTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJZiBnZW9wb3NlIGlzIGF2YWlsYWJsZSwgdGhpcyBpcyB0aGUgdmVydGljYWwgYWNjdXJhY3kgb2YgdGhlIHVzZXIgZ2VvbG9jYXRpb25cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IGdlb0hvcml6b250YWxBY2N1cmFjeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5nZW9Ib3Jpem9udGFsQWNjdXJhY3k7XG4gICAgfVxuXG4gICAgcHVibGljIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuc2Vzc2lvbi5tYW5hZ2VyLmNsb3NlKCk7XG4gICAgICAgIGlmIChBcmdvblN5c3RlbS5pbnN0YW5jZSA9PT0gdGhpcykge1xuICAgICAgICAgICAgQXJnb25TeXN0ZW0uaW5zdGFuY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBcmdvbkNvbnRhaW5lck1hbmFnZXIge1xuXG4gICAgc3RhdGljIGNvbmZpZ3VyZShjb25maWd1cmF0aW9uTWFuYWdlcjpBcmdvbkNvbnRhaW5lck1hbmFnZXIpIHtcbiAgICAgICAgY29uZmlndXJhdGlvbk1hbmFnZXIuc3RhbmRhcmRDb25maWd1cmF0aW9uKCk7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBjb25maWd1cmF0aW9uOkNvbmZpZ3VyYXRpb24sIFxuICAgICAgICBwdWJsaWMgY29udGFpbmVyOkRJLkNvbnRhaW5lciA9IG5ldyBESS5Db250YWluZXIsXG4gICAgICAgIHB1YmxpYyBlbGVtZW50T3JTZWxlY3Rvcj86SFRNTEVsZW1lbnR8c3RyaW5nfG51bGwsXG4gICAgKSB7XG4gICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlckluc3RhbmNlKENvbmZpZ3VyYXRpb24sIGNvbmZpZ3VyYXRpb24pO1xuICAgICAgICBcbiAgICAgICAgaWYgKFJvbGUuaXNSZWFsaXR5TWFuYWdlcihjb25maWd1cmF0aW9uLnJvbGUpKSB7XG4gICAgICAgICAgICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b24oQXJnb25TeXN0ZW1Qcm92aWRlcik7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZWxlbWVudCA9IGVsZW1lbnRPclNlbGVjdG9yO1xuICAgICAgICBpZiAoIWVsZW1lbnQgfHwgdHlwZW9mIGVsZW1lbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdG9yID0gZWxlbWVudDtcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gc2VsZWN0b3IgPyA8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcikgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKCFlbGVtZW50ICYmICFzZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FyZ29uJykgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9ICdhcmdvbic7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBmaW5kIGVsZW1lbnQgd2l0aCBzZWxlY3RvcjogJyArIHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB2aWV3SXRlbXMgPSBuZXcgVmlld0l0ZW1zKCk7XG4gICAgICAgIHZpZXdJdGVtcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVySW5zdGFuY2UoVmlld0l0ZW1zLCB2aWV3SXRlbXMpO1xuXG4gICAgICAgIEFyZ29uQ29udGFpbmVyTWFuYWdlci5jb25maWd1cmUodGhpcyk7XG4gICAgfVxuXG4gICAgZ2V0IGFwcCgpIDogQXJnb25TeXN0ZW0ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXIuZ2V0KEFyZ29uU3lzdGVtKTtcbiAgICB9XG4gICAgXG4gICAgc3RhbmRhcmRDb25maWd1cmF0aW9uKCkge1xuICAgICAgICB0aGlzLmRlZmF1bHRDb25uZWN0KCk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFJlYWxpdHlGYWN0b3J5KCk7XG4gICAgICAgIHRoaXMuZGVmYXVsdFVJKCk7XG4gICAgfVxuXG4gICAgZGVmYXVsdENvbm5lY3QoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyO1xuICAgICAgICBjb25zdCBjb25maWd1cmF0aW9uID0gdGhpcy5jb25maWd1cmF0aW9uO1xuXG4gICAgICAgIGlmIChSb2xlLmlzUmVhbGl0eU1hbmFnZXIoY29uZmlndXJhdGlvbi5yb2xlKSkge1xuICAgICAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFxuICAgICAgICAgICAgICAgIENvbm5lY3RTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIExvb3BiYWNrQ29ubmVjdFNlcnZpY2VcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSBpZiAoV0tXZWJWaWV3Q29ubmVjdFNlcnZpY2UuaXNBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFxuICAgICAgICAgICAgICAgIENvbm5lY3RTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIFdLV2ViVmlld0Nvbm5lY3RTZXJ2aWNlXG4gICAgICAgICAgICApXG4gICAgICAgIH0gZWxzZSBpZiAoQW5kcm9pZFdlYlZpZXdDb25uZWN0U2VydmljZS5pc0F2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICBjb250YWluZXIucmVnaXN0ZXJTaW5nbGV0b24oXG4gICAgICAgICAgICAgICAgQ29ubmVjdFNlcnZpY2UsXG4gICAgICAgICAgICAgICAgQW5kcm9pZFdlYlZpZXdDb25uZWN0U2VydmljZVxuICAgICAgICAgICAgKVxuICAgICAgICB9IGVsc2UgaWYgKERPTUNvbm5lY3RTZXJ2aWNlLmlzQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lci5yZWdpc3RlclNpbmdsZXRvbihcbiAgICAgICAgICAgICAgICBDb25uZWN0U2VydmljZSxcbiAgICAgICAgICAgICAgICBET01Db25uZWN0U2VydmljZVxuICAgICAgICAgICAgKVxuICAgICAgICB9IGVsc2UgaWYgKERlYnVnQ29ubmVjdFNlcnZpY2UuaXNBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFxuICAgICAgICAgICAgICAgIENvbm5lY3RTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIERlYnVnQ29ubmVjdFNlcnZpY2VcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZWZhdWx0UmVhbGl0eUZhY3RvcnkoKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlZ2lzdGVyU2luZ2xldG9uKFxuICAgICAgICAgICAgUmVhbGl0eUZhY3RvcnksIFxuICAgICAgICAgICAgRGVmYXVsdFJlYWxpdHlGYWN0b3J5XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgZGVmYXVsdFVJKCkge1xuICAgICAgICBpZiAoUm9sZS5pc1JlYWxpdHlNYW5hZ2VyKHRoaXMuY29uZmlndXJhdGlvbi5yb2xlKSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5nZXQoRGVmYXVsdFVJU2VydmljZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBcbn1cblxuQERJLmF1dG9pbmplY3RcbmNsYXNzIERlZmF1bHRSZWFsaXR5RmFjdG9yeSB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjb250YWluZXI6REkuQ29udGFpbmVyKSB7fTtcbiAgICBjcmVhdGVSZWFsaXR5Vmlld2VyKHVyaTpzdHJpbmcpIDogUmVhbGl0eVZpZXdlciB7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ2NyZWF0aW5nICcgKyB1cmkpXG4gICAgICAgIHN3aXRjaCAoUmVhbGl0eVZpZXdlci5nZXRUeXBlKHVyaSkpIHtcbiAgICAgICAgICAgIGNhc2UgUmVhbGl0eVZpZXdlci5FTVBUWTogXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyLmludm9rZShFbXB0eVJlYWxpdHlWaWV3ZXIsIFt1cmldKTtcbiAgICAgICAgICAgIGNhc2UgUmVhbGl0eVZpZXdlci5MSVZFOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lci5pbnZva2UoTGl2ZVJlYWxpdHlWaWV3ZXIsIFt1cmldKTtcbiAgICAgICAgICAgIGNhc2UgUmVhbGl0eVZpZXdlci5XRUJSVEM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGFpbmVyLmludm9rZShXZWJSVENSZWFsaXR5Vmlld2VyLCBbdXJpXSk7XG4gICAgICAgICAgICBjYXNlICdob3N0ZWQnOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lci5pbnZva2UoSG9zdGVkUmVhbGl0eVZpZXdlciwgW3VyaV0pO1xuICAgICAgICAgICAgY2FzZSBSZWFsaXR5Vmlld2VyLlRBTkdPOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5lci5pbnZva2UoVGFuZ29SZWFsaXR5Vmlld2VyLCBbdXJpXSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgUmVhbGl0eSBWaWV3ZXI6ICcgKyB1cmkpXG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGFuIEFyZ29uU3lzdGVtIGluc3RhbmNlLiBcbiAqIElmIHdlIGFyZSBydW5uaW5nIHdpdGhpbiBhIFtbUkVBTElUWV9NQU5BR0VSXV0sIFxuICogdGhpcyBmdW5jdGlvbiB3aWxsIGNyZWF0ZSBhbiBBcmdvblN5c3RlbSB3aGljaCBoYXMgdGhlIFtbUkVBTElUWV9BVUdNRU5UT1JdXSByb2xlLiBcbiAqIElmIHdlIGFyZSBub3QgcnVubmluZyB3aXRoaW4gYSBbW1JFQUxJVFlfTUFOQUdFUl1dLCBcbiAqIHRoaXMgZnVuY3Rpb24gd2lsbCBjcmVhdGUgYW4gQXJnb25TeXN0ZW0gd2hpY2ggaGFzIHRoZSBbW1JFQUxJVFlfTUFOQUdFUl1dIHJvbGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0KGNvbmZpZ3VyYXRpb24/OiBDb25maWd1cmF0aW9uLCBkZXBlbmRlbmN5SW5qZWN0aW9uQ29udGFpbmVyPzpESS5Db250YWluZXIpIDogQXJnb25TeXN0ZW07XG5leHBvcnQgZnVuY3Rpb24gaW5pdChlbGVtZW50Pzogc3RyaW5nfEhUTUxEaXZFbGVtZW50fG51bGwsIGNvbmZpZ3VyYXRpb24/OiBDb25maWd1cmF0aW9uLCBkZXBlbmRlbmN5SW5qZWN0aW9uQ29udGFpbmVyPzpESS5Db250YWluZXIpIDogQXJnb25TeXN0ZW07XG5leHBvcnQgZnVuY3Rpb24gaW5pdChcbiAgICAgICAgZWxlbWVudE9yQ29uZmlnPzogYW55LFxuICAgICAgICBjb25maWd1cmF0aW9uT3JESUNvbnRhaW5lcj86IGFueSxcbiAgICAgICAgZGVwZW5kZW5jeUluamVjdGlvbkNvbnRhaW5lcj86REkuQ29udGFpbmVyXG4gICAgKSA6IEFyZ29uU3lzdGVtIHtcbiAgICBpZiAoQXJnb25TeXN0ZW0uaW5zdGFuY2UpIHRocm93IG5ldyBFcnJvcignQSBzaGFyZWQgQXJnb25TeXN0ZW0gaW5zdGFuY2UgYWxyZWFkeSBleGlzdHMnKTtcblxuICAgIGxldCBlbGVtZW50OnN0cmluZ3xIVE1MRGl2RWxlbWVudHx1bmRlZmluZWQ7XG4gICAgbGV0IGNvbmZpZ3VyYXRpb246Q29uZmlndXJhdGlvbnx1bmRlZmluZWQ7XG4gICAgaWYgKGNvbmZpZ3VyYXRpb25PckRJQ29udGFpbmVyIGluc3RhbmNlb2YgREkuQ29udGFpbmVyKSB7XG4gICAgICAgIGNvbmZpZ3VyYXRpb24gPSBlbGVtZW50T3JDb25maWc7XG4gICAgICAgIGRlcGVuZGVuY3lJbmplY3Rpb25Db250YWluZXIgPSBjb25maWd1cmF0aW9uT3JESUNvbnRhaW5lcjtcbiAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50ID0gZWxlbWVudE9yQ29uZmlnO1xuICAgICAgICBjb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbk9yRElDb250YWluZXI7XG4gICAgfVxuXG4gICAgLy8gc2VlIGlmIGl0IGlzIHRoZSBvbGQgcGFyYW1ldGVyIGludGVyZmFjZVxuICAgIGlmIChlbGVtZW50ICYmIChlbGVtZW50Wydjb25maWd1cmF0aW9uJ10gfHwgZWxlbWVudFsnY29udGFpbmVyJ10pKSB7XG4gICAgICAgIGNvbnN0IGRlcHJlY2F0ZWRQYXJhbWV0ZXJzID0gZWxlbWVudDtcbiAgICAgICAgaWYgKCFjb25maWd1cmF0aW9uICYmIGRlcHJlY2F0ZWRQYXJhbWV0ZXJzWydjb25maWd1cmF0aW9uJ10pXG4gICAgICAgICAgICBjb25maWd1cmF0aW9uID0gZGVwcmVjYXRlZFBhcmFtZXRlcnNbJ2NvbmZpZ3VyYXRpb24nXTtcbiAgICAgICAgaWYgKCFjb25maWd1cmF0aW9uICYmIGRlcHJlY2F0ZWRQYXJhbWV0ZXJzWydjb250YWluZXInXSlcbiAgICAgICAgICAgIGRlcGVuZGVuY3lJbmplY3Rpb25Db250YWluZXIgPSBkZXByZWNhdGVkUGFyYW1ldGVyc1snY29udGFpbmVyJ107XG4gICAgICAgIGVsZW1lbnQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKCFjb25maWd1cmF0aW9uKSBjb25maWd1cmF0aW9uID0ge307XG4gICAgaWYgKCFjb25maWd1cmF0aW9uLnJvbGUpIHtcbiAgICAgICAgbGV0IHJvbGU6IFJvbGU7XG4gICAgICAgIGlmICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICByb2xlID0gUm9sZS5SRUFMSVRZX01BTkFHRVJcbiAgICAgICAgfSBlbHNlIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ0FyZ29uJykgPiAwIHx8IHdpbmRvdy50b3AgIT09IHdpbmRvdykge1xuICAgICAgICAgICAgcm9sZSA9IFJvbGUuQVBQTElDQVRJT04gLy8gVE9ETzogc3dpdGNoIHRvIGJlbG93IGFmdGVyIHNldmVyYWwgYXJnb24tYXBwIHJlbGVhc2VzXG4gICAgICAgICAgICAvLyByb2xlID0gUm9sZS5SRUFMSVRZX0FVR01FTlRFUlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcm9sZSA9IFJvbGUuUkVBTElUWV9NQU5BR0VSXG4gICAgICAgIH1cbiAgICAgICAgY29uZmlndXJhdGlvbi5yb2xlID0gcm9sZTtcbiAgICB9XG5cbiAgICBpZiAoIWRlcGVuZGVuY3lJbmplY3Rpb25Db250YWluZXIpIGRlcGVuZGVuY3lJbmplY3Rpb25Db250YWluZXIgPSBuZXcgREkuQ29udGFpbmVyKCk7XG5cbiAgICByZXR1cm4gbmV3IEFyZ29uQ29udGFpbmVyTWFuYWdlcihjb25maWd1cmF0aW9uLCBkZXBlbmRlbmN5SW5qZWN0aW9uQ29udGFpbmVyLCBlbGVtZW50KS5hcHA7XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBhbiBbW0FyZ29uU3lzdGVtXV0gd2l0aCB0aGUgW1tSRUFMSVRZX1ZJRVdFUl1dIHJvbGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRSZWFsaXR5Vmlld2VyKFxuICAgICAgICBjb25maWd1cmF0aW9uOkNvbmZpZ3VyYXRpb24gPSB7fSxcbiAgICAgICAgZGVwZW5kZW5jeUluamVjdGlvbkNvbnRhaW5lcjpESS5Db250YWluZXIgPSBuZXcgREkuQ29udGFpbmVyXG4gICAgKSA6IEFyZ29uU3lzdGVtIHtcbiAgICBpZiAoQXJnb25TeXN0ZW0uaW5zdGFuY2UpIHRocm93IG5ldyBFcnJvcignQSBzaGFyZWQgQXJnb25TeXN0ZW0gaW5zdGFuY2UgYWxyZWFkeSBleGlzdHMnKTtcblxuICAgIGNvbmZpZ3VyYXRpb24ucm9sZSA9IFJvbGUuUkVBTElUWV9WSUVXOyAvLyBUT0RPOiBzd2l0Y2ggdG8gYmVsb3cgYWZ0ZXIgc2V2ZXJhbCBhcmdvbi1hcHAgcmVsZWFzZXNcbiAgICAvLyBjb25maWd1cmF0aW9uLnJvbGUgPSBSb2xlLlJFQUxJVFlfVklFV0VSO1xuICAgIGNvbmZpZ3VyYXRpb25bJ3N1cHBvcnRzQ3VzdG9tUHJvdG9jb2xzJ10gPSB0cnVlO1xuICAgIGNvbmZpZ3VyYXRpb25bJ3JlYWxpdHkuc3VwcG9ydHNDb250cm9sUG9ydCddID0gdHJ1ZTsgLy8gYmFja3dhcmRzIGNvbXBhdCBmb3IgYWJvdmVcbiAgICBjb25maWd1cmF0aW9uLnByb3RvY29scyA9IGNvbmZpZ3VyYXRpb24ucHJvdG9jb2xzIHx8IFtdO1xuICAgIGNvbmZpZ3VyYXRpb24ucHJvdG9jb2xzLnB1c2goJ2FyLnVpZXZlbnQnKVxuICAgIHJldHVybiBuZXcgQXJnb25Db250YWluZXJNYW5hZ2VyKGNvbmZpZ3VyYXRpb24sIGRlcGVuZGVuY3lJbmplY3Rpb25Db250YWluZXIpLmFwcDtcbn1cblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgY29uc3QgaW5pdFJlYWxpdHkgPSBpbml0UmVhbGl0eVZpZXdlcjsiXX0=